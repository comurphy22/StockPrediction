/Users/tobycoleman/mining/StockPrediction/venv/lib/python3.13/site-packages/xgboost/training.py:199: UserWarning: [14:53:38] WARNING: /Users/runner/work/xgboost/xgboost/src/learner.cc:790: 
Parameters: { "use_label_encoder" } are not used.

  bst.update(dtrain, iteration=i, fobj=obj)
/Users/tobycoleman/mining/StockPrediction/venv/lib/python3.13/site-packages/xgboost/training.py:199: UserWarning: [14:53:39] WARNING: /Users/runner/work/xgboost/xgboost/src/learner.cc:790: 
Parameters: { "use_label_encoder" } are not used.

  bst.update(dtrain, iteration=i, fobj=obj)
/Users/tobycoleman/mining/StockPrediction/venv/lib/python3.13/site-packages/xgboost/training.py:199: UserWarning: [14:53:40] WARNING: /Users/runner/work/xgboost/xgboost/src/learner.cc:790: 
Parameters: { "use_label_encoder" } are not used.

  bst.update(dtrain, iteration=i, fobj=obj)
/Users/tobycoleman/mining/StockPrediction/venv/lib/python3.13/site-packages/xgboost/training.py:199: UserWarning: [14:53:55] WARNING: /Users/runner/work/xgboost/xgboost/src/learner.cc:790: 
Parameters: { "use_label_encoder" } are not used.

  bst.update(dtrain, iteration=i, fobj=obj)
/Users/tobycoleman/mining/StockPrediction/venv/lib/python3.13/site-packages/xgboost/training.py:199: UserWarning: [14:53:56] WARNING: /Users/runner/work/xgboost/xgboost/src/learner.cc:790: 
Parameters: { "use_label_encoder" } are not used.

  bst.update(dtrain, iteration=i, fobj=obj)
/Users/tobycoleman/mining/StockPrediction/venv/lib/python3.13/site-packages/xgboost/training.py:199: UserWarning: [14:53:57] WARNING: /Users/runner/work/xgboost/xgboost/src/learner.cc:790: 
Parameters: { "use_label_encoder" } are not used.

  bst.update(dtrain, iteration=i, fobj=obj)
================================================================================
OVERFITTING FIX EXPERIMENTS
================================================================================
Started: 2025-11-04 14:53:35

[1/4] Loading optimal feature set...
‚úÖ Loaded 25 features

[2/4] Defining hyperparameter grid...
Parameter ranges:
  max_depth: [3, 4, 5, 6]
  min_child_weight: [1, 3, 5]
  alpha: [0, 0.1, 1.0]
  gamma: [0, 0.1, 0.5]
  lambda: [1, 5, 10]

[3/4] Testing 13 configurations on 3 stocks...
================================================================================

[1/13] Testing: Baseline
--------------------------------------------------------------------------------
Successfully fetched 251 days of data for NFLX
üìÇ Loading from cache (fast)...
‚úÖ Loaded 4653355 cached articles
   üìä Found 803 articles (798 direct + 636 keyword)
   ü§ñ Calculating sentiment...
   ‚úÖ Processed 803 articles with sentiment
Fetching politician trading data for NFLX...
Successfully fetched 373 politician trades for NFLX
Date range: 2014-04-03 to 2025-10-28

Transaction type breakdown:
transaction_type
purchase          194
sale              144
sale (full)        31
sale (partial)      3
exchange            1
Name: count, dtype: int64
Creating SMA indicators...
Creating RSI indicator...
Creating MACD indicators...
Merging sentiment data...
Merging politician trade data...
Creating advanced politician features...
üèõÔ∏è  Creating advanced politician features...
   ‚úÖ Net position indicators: net_trade_index, net_dollar_flow, buy_percentage
   ‚úÖ Temporal features: 3 rolling windows + momentum
   ‚úÖ Recency indicator: days_since_last_trade
   ‚úÖ Quality metrics: conviction_score
   ‚úÖ Added 23 advanced politician features
      ‚úÖ Added 23 advanced politician features
Creating target variable...

Feature engineering complete!
Features shape: (250, 41)
Target shape: (250,)
Features: ['SMA_10', 'SMA_20', 'SMA_50', 'RSI', 'MACD', 'MACD_signal', 'MACD_diff', 'Price_change', 'Volume_change', 'HL_spread', 'SMA_10_20_cross', 'SMA_20_50_cross', 'avg_sentiment_compound', 'avg_sentiment_positive', 'avg_sentiment_negative', 'news_count', 'politician_buy_count', 'politician_trade_amount', 'buy_count', 'sell_count', 'full_sale_count', 'partial_sale_count', 'total_amount', 'buy_amount', 'sell_amount', 'net_trade_index', 'net_dollar_flow', 'buy_percentage', 'trades_last_30d', 'amount_last_30d', 'net_flow_last_30d', 'trades_last_60d', 'amount_last_60d', 'net_flow_last_60d', 'trades_last_90d', 'amount_last_90d', 'net_flow_last_90d', 'trade_momentum_30d', 'dollar_momentum_30d', 'days_since_last_trade', 'conviction_score']

Target distribution:
Target
1    129
0    121
Name: count, dtype: int64
Class balance: 51.60% positive (price increase)

Missing values before handling:
SMA_10              9
SMA_20             19
SMA_50             49
RSI                13
MACD               25
MACD_signal        33
MACD_diff          33
Price_change        1
Volume_change       1
SMA_10_20_cross    19
SMA_20_50_cross    49
news_count         49
dtype: int64
Dropped 86 rows with missing values
Missing values after handling: 0
   NFLX: Train=100.0%, Test=60.6%, Gap=39.4%
Successfully fetched 251 days of data for NVDA
   üìä Found 513 articles (505 direct + 307 keyword)
   ü§ñ Calculating sentiment...
   ‚úÖ Processed 513 articles with sentiment
Fetching politician trading data for NVDA...
Successfully fetched 581 politician trades for NVDA
Date range: 2016-01-20 to 2025-11-03

Transaction type breakdown:
transaction_type
purchase          325
sale              227
sale (full)        16
sale (partial)     10
exchange            3
Name: count, dtype: int64
Creating SMA indicators...
Creating RSI indicator...
Creating MACD indicators...
Merging sentiment data...
Merging politician trade data...
Creating advanced politician features...
üèõÔ∏è  Creating advanced politician features...
   ‚úÖ Net position indicators: net_trade_index, net_dollar_flow, buy_percentage
   ‚úÖ Temporal features: 3 rolling windows + momentum
   ‚úÖ Recency indicator: days_since_last_trade
   ‚úÖ Quality metrics: conviction_score
   ‚úÖ Added 23 advanced politician features
      ‚úÖ Added 23 advanced politician features
Creating target variable...

Feature engineering complete!
Features shape: (250, 41)
Target shape: (250,)
Features: ['SMA_10', 'SMA_20', 'SMA_50', 'RSI', 'MACD', 'MACD_signal', 'MACD_diff', 'Price_change', 'Volume_change', 'HL_spread', 'SMA_10_20_cross', 'SMA_20_50_cross', 'avg_sentiment_compound', 'avg_sentiment_positive', 'avg_sentiment_negative', 'news_count', 'politician_buy_count', 'politician_trade_amount', 'buy_count', 'sell_count', 'full_sale_count', 'partial_sale_count', 'total_amount', 'buy_amount', 'sell_amount', 'net_trade_index', 'net_dollar_flow', 'buy_percentage', 'trades_last_30d', 'amount_last_30d', 'net_flow_last_30d', 'trades_last_60d', 'amount_last_60d', 'net_flow_last_60d', 'trades_last_90d', 'amount_last_90d', 'net_flow_last_90d', 'trade_momentum_30d', 'dollar_momentum_30d', 'days_since_last_trade', 'conviction_score']

Target distribution:
Target
1    136
0    114
Name: count, dtype: int64
Class balance: 54.40% positive (price increase)

Missing values before handling:
SMA_10              9
SMA_20             19
SMA_50             49
RSI                13
MACD               25
MACD_signal        33
MACD_diff          33
Price_change        1
Volume_change       1
SMA_10_20_cross    19
SMA_20_50_cross    49
news_count         74
dtype: int64
Dropped 105 rows with missing values
Missing values after handling: 0
   NVDA: Train=100.0%, Test=37.9%, Gap=62.1%
Successfully fetched 251 days of data for BABA
   üìä Found 450 articles (444 direct + 333 keyword)
   ü§ñ Calculating sentiment...
   ‚úÖ Processed 450 articles with sentiment
Fetching politician trading data for BABA...
Successfully fetched 238 politician trades for BABA
Date range: 2014-10-16 to 2025-10-05

Transaction type breakdown:
transaction_type
purchase          126
sale               98
sale (full)        13
sale (partial)      1
Name: count, dtype: int64
Creating SMA indicators...
Creating RSI indicator...
Creating MACD indicators...
Merging sentiment data...
Merging politician trade data...
Creating advanced politician features...
üèõÔ∏è  Creating advanced politician features...
   ‚úÖ Net position indicators: net_trade_index, net_dollar_flow, buy_percentage
   ‚úÖ Temporal features: 3 rolling windows + momentum
   ‚úÖ Recency indicator: days_since_last_trade
   ‚úÖ Quality metrics: conviction_score
   ‚úÖ Added 23 advanced politician features
      ‚úÖ Added 23 advanced politician features
Creating target variable...

Feature engineering complete!
Features shape: (250, 41)
Target shape: (250,)
Features: ['SMA_10', 'SMA_20', 'SMA_50', 'RSI', 'MACD', 'MACD_signal', 'MACD_diff', 'Price_change', 'Volume_change', 'HL_spread', 'SMA_10_20_cross', 'SMA_20_50_cross', 'avg_sentiment_compound', 'avg_sentiment_positive', 'avg_sentiment_negative', 'news_count', 'politician_buy_count', 'politician_trade_amount', 'buy_count', 'sell_count', 'full_sale_count', 'partial_sale_count', 'total_amount', 'buy_amount', 'sell_amount', 'net_trade_index', 'net_dollar_flow', 'buy_percentage', 'trades_last_30d', 'amount_last_30d', 'net_flow_last_30d', 'trades_last_60d', 'amount_last_60d', 'net_flow_last_60d', 'trades_last_90d', 'amount_last_90d', 'net_flow_last_90d', 'trade_momentum_30d', 'dollar_momentum_30d', 'days_since_last_trade', 'conviction_score']

Target distribution:
Target
1    141
0    109
Name: count, dtype: int64
Class balance: 56.40% positive (price increase)

Missing values before handling:
SMA_10              9
SMA_20             19
SMA_50             49
RSI                13
MACD               25
MACD_signal        33
MACD_diff          33
Price_change        1
Volume_change       1
SMA_10_20_cross    19
SMA_20_50_cross    49
news_count         61
dtype: int64
Dropped 97 rows with missing values
Missing values after handling: 0
   BABA: Train=100.0%, Test=64.5%, Gap=35.5%
   üìä Average: Train=100.0%, Test=54.4%, Gap=45.6%

[2/13] Testing: MaxDepth=3
--------------------------------------------------------------------------------/Users/tobycoleman/mining/StockPrediction/venv/lib/python3.13/site-packages/xgboost/training.py:199: UserWarning: [14:53:57] WARNING: /Users/runner/work/xgboost/xgboost/src/learner.cc:790: 
Parameters: { "use_label_encoder" } are not used.

  bst.update(dtrain, iteration=i, fobj=obj)
/Users/tobycoleman/mining/StockPrediction/venv/lib/python3.13/site-packages/xgboost/training.py:199: UserWarning: [14:53:58] WARNING: /Users/runner/work/xgboost/xgboost/src/learner.cc:790: 
Parameters: { "use_label_encoder" } are not used.

  bst.update(dtrain, iteration=i, fobj=obj)
/Users/tobycoleman/mining/StockPrediction/venv/lib/python3.13/site-packages/xgboost/training.py:199: UserWarning: [14:53:58] WARNING: /Users/runner/work/xgboost/xgboost/src/learner.cc:790: 
Parameters: { "use_label_encoder" } are not used.

  bst.update(dtrain, iteration=i, fobj=obj)
/Users/tobycoleman/mining/StockPrediction/venv/lib/python3.13/site-packages/xgboost/training.py:199: UserWarning: [14:53:59] WARNING: /Users/runner/work/xgboost/xgboost/src/learner.cc:790: 
Parameters: { "use_label_encoder" } are not used.

  bst.update(dtrain, iteration=i, fobj=obj)

Successfully fetched 251 days of data for NFLX
   üìä Found 803 articles (798 direct + 636 keyword)
   ü§ñ Calculating sentiment...
   ‚úÖ Processed 803 articles with sentiment
Fetching politician trading data for NFLX...
Error fetching politician trades: HTTPSConnectionPool(host='api.quiverquant.com', port=443): Read timed out. (read timeout=15)
Returning empty DataFrame
Creating SMA indicators...
Creating RSI indicator...
Creating MACD indicators...
Merging sentiment data...
No politician trade data provided - skipping politician features
Creating target variable...

Feature engineering complete!
Features shape: (250, 16)
Target shape: (250,)
Features: ['SMA_10', 'SMA_20', 'SMA_50', 'RSI', 'MACD', 'MACD_signal', 'MACD_diff', 'Price_change', 'Volume_change', 'HL_spread', 'SMA_10_20_cross', 'SMA_20_50_cross', 'avg_sentiment_compound', 'avg_sentiment_positive', 'avg_sentiment_negative', 'news_count']

Target distribution:
Target
1    129
0    121
Name: count, dtype: int64
Class balance: 51.60% positive (price increase)

Missing values before handling:
SMA_10              9
SMA_20             19
SMA_50             49
RSI                13
MACD               25
MACD_signal        33
MACD_diff          33
Price_change        1
Volume_change       1
SMA_10_20_cross    19
SMA_20_50_cross    49
news_count         49
dtype: int64
Dropped 86 rows with missing values
Missing values after handling: 0
   NFLX: Train=100.0%, Test=45.5%, Gap=54.5%
Successfully fetched 251 days of data for NVDA
   üìä Found 513 articles (505 direct + 307 keyword)
   ü§ñ Calculating sentiment...
   ‚úÖ Processed 513 articles with sentiment
Fetching politician trading data for NVDA...
Successfully fetched 581 politician trades for NVDA
Date range: 2016-01-20 to 2025-11-03

Transaction type breakdown:
transaction_type
purchase          325
sale              227
sale (full)        16
sale (partial)     10
exchange            3
Name: count, dtype: int64
Creating SMA indicators...
Creating RSI indicator...
Creating MACD indicators...
Merging sentiment data...
Merging politician trade data...
Creating advanced politician features...
üèõÔ∏è  Creating advanced politician features...
   ‚úÖ Net position indicators: net_trade_index, net_dollar_flow, buy_percentage
   ‚úÖ Temporal features: 3 rolling windows + momentum
   ‚úÖ Recency indicator: days_since_last_trade
   ‚úÖ Quality metrics: conviction_score
   ‚úÖ Added 23 advanced politician features
      ‚úÖ Added 23 advanced politician features
Creating target variable...

Feature engineering complete!
Features shape: (250, 41)
Target shape: (250,)
Features: ['SMA_10', 'SMA_20', 'SMA_50', 'RSI', 'MACD', 'MACD_signal', 'MACD_diff', 'Price_change', 'Volume_change', 'HL_spread', 'SMA_10_20_cross', 'SMA_20_50_cross', 'avg_sentiment_compound', 'avg_sentiment_positive', 'avg_sentiment_negative', 'news_count', 'politician_buy_count', 'politician_trade_amount', 'buy_count', 'sell_count', 'full_sale_count', 'partial_sale_count', 'total_amount', 'buy_amount', 'sell_amount', 'net_trade_index', 'net_dollar_flow', 'buy_percentage', 'trades_last_30d', 'amount_last_30d', 'net_flow_last_30d', 'trades_last_60d', 'amount_last_60d', 'net_flow_last_60d', 'trades_last_90d', 'amount_last_90d', 'net_flow_last_90d', 'trade_momentum_30d', 'dollar_momentum_30d', 'days_since_last_trade', 'conviction_score']

Target distribution:
Target
1    136
0    114
Name: count, dtype: int64
Class balance: 54.40% positive (price increase)

Missing values before handling:
SMA_10              9
SMA_20             19
SMA_50             49
RSI                13
MACD               25
MACD_signal        33
MACD_diff          33
Price_change        1
Volume_change       1
SMA_10_20_cross    19
SMA_20_50_cross    49
news_count         74
dtype: int64
Dropped 105 rows with missing values
Missing values after handling: 0
   NVDA: Train=100.0%, Test=44.8%, Gap=55.2%
Successfully fetched 251 days of data for BABA
   üìä Found 450 articles (444 direct + 333 keyword)
   ü§ñ Calculating sentiment...
   ‚úÖ Processed 450 articles with sentiment
Fetching politician trading data for BABA...
Successfully fetched 238 politician trades for BABA
Date range: 2014-10-16 to 2025-10-05

Transaction type breakdown:
transaction_type
purchase          126
sale               98
sale (full)        13
sale (partial)      1
Name: count, dtype: int64
Creating SMA indicators...
Creating RSI indicator...
Creating MACD indicators...
Merging sentiment data...
Merging politician trade data...
Creating advanced politician features...
üèõÔ∏è  Creating advanced politician features...
   ‚úÖ Net position indicators: net_trade_index, net_dollar_flow, buy_percentage
   ‚úÖ Temporal features: 3 rolling windows + momentum
   ‚úÖ Recency indicator: days_since_last_trade
   ‚úÖ Quality metrics: conviction_score
   ‚úÖ Added 23 advanced politician features
      ‚úÖ Added 23 advanced politician features
Creating target variable...

Feature engineering complete!
Features shape: (250, 41)
Target shape: (250,)
Features: ['SMA_10', 'SMA_20', 'SMA_50', 'RSI', 'MACD', 'MACD_signal', 'MACD_diff', 'Price_change', 'Volume_change', 'HL_spread', 'SMA_10_20_cross', 'SMA_20_50_cross', 'avg_sentiment_compound', 'avg_sentiment_positive', 'avg_sentiment_negative', 'news_count', 'politician_buy_count', 'politician_trade_amount', 'buy_count', 'sell_count', 'full_sale_count', 'partial_sale_count', 'total_amount', 'buy_amount', 'sell_amount', 'net_trade_index', 'net_dollar_flow', 'buy_percentage', 'trades_last_30d', 'amount_last_30d', 'net_flow_last_30d', 'trades_last_60d', 'amount_last_60d', 'net_flow_last_60d', 'trades_last_90d', 'amount_last_90d', 'net_flow_last_90d', 'trade_momentum_30d', 'dollar_momentum_30d', 'days_since_last_trade', 'conviction_score']

Target distribution:
Target
1    141
0    109
Name: count, dtype: int64
Class balance: 56.40% positive (price increase)

Missing values before handling:
SMA_10              9
SMA_20             19
SMA_50             49
RSI                13
MACD               25
MACD_signal        33
MACD_diff          33
Price_change        1
Volume_change       1
SMA_10_20_cross    19
SMA_20_50_cross    49
news_count         61
dtype: int64
Dropped 97 rows with missing values
Missing values after handling: 0
   BABA: Train=100.0%, Test=71.0%, Gap=29.0%
   üìä Average: Train=100.0%, Test=53.7%, Gap=46.3%

[3/13] Testing: MaxDepth=4
--------------------------------------------------------------------------------
Successfully fetched 251 days of data for NFLX
   üìä Found 803 articles (798 direct + 636 keyword)
   ü§ñ Calculating sentiment...
   ‚úÖ Processed 803 articles with sentiment
Fetching politician trading data for NFLX...
Successfully fetched 373 politician trades for NFLX
Date range: 2014-04-03 to 2025-10-28

Transaction type breakdown:
transaction_type
purchase          194
sale              144
sale (full)        31
sale (partial)      3
exchange            1
Name: count, dtype: int64
Creating SMA indicators...
Creating RSI indicator...
Creating MACD indicators...
Merging sentiment data...
Merging politician trade data...
Creating advanced politician features...
üèõÔ∏è  Creating advanced politician features...
   ‚úÖ Net position indicators: net_trade_index, net_dollar_flow, buy_percentage
   ‚úÖ Temporal features: 3 rolling windows + momentum
   ‚úÖ Recency indicator: days_since_last_trade
   ‚úÖ Quality metrics: conviction_score
   ‚úÖ Added 23 advanced politician features
      ‚úÖ Added 23 advanced politician features
Creating target variable...

Feature engineering complete!
Features shape: (250, 41)
Target shape: (250,)
Features: ['SMA_10', 'SMA_20', 'SMA_50', 'RSI', 'MACD', 'MACD_signal', 'MACD_diff', 'Price_change', 'Volume_change', 'HL_spread', 'SMA_10_20_cross', 'SMA_20_50_cross', 'avg_sentiment_compound', 'avg_sentiment_positive', 'avg_sentiment_negative', 'news_count', 'politician_buy_count', 'politician_trade_amount', 'buy_count', 'sell_count', 'full_sale_count', 'partial_sale_count', 'total_amount', 'buy_amount', 'sell_amount', 'net_trade_index', 'net_dollar_flow', 'buy_percentage', 'trades_last_30d', 'amount_last_30d', 'net_flow_last_30d', 'trades_last_60d', 'amount_last_60d', 'net_flow_last_60d', 'trades_last_90d', 'amount_last_90d', 'net_flow_last_90d', 'trade_momentum_30d', 'dollar_momentum_30d', 'days_since_last_trade', 'conviction_score']/Users/tobycoleman/mining/StockPrediction/venv/lib/python3.13/site-packages/xgboost/training.py:199: UserWarning: [14:53:59] WARNING: /Users/runner/work/xgboost/xgboost/src/learner.cc:790: 
Parameters: { "use_label_encoder" } are not used.

  bst.update(dtrain, iteration=i, fobj=obj)
/Users/tobycoleman/mining/StockPrediction/venv/lib/python3.13/site-packages/xgboost/training.py:199: UserWarning: [14:54:00] WARNING: /Users/runner/work/xgboost/xgboost/src/learner.cc:790: 
Parameters: { "use_label_encoder" } are not used.

  bst.update(dtrain, iteration=i, fobj=obj)
/Users/tobycoleman/mining/StockPrediction/venv/lib/python3.13/site-packages/xgboost/training.py:199: UserWarning: [14:54:00] WARNING: /Users/runner/work/xgboost/xgboost/src/learner.cc:790: 
Parameters: { "use_label_encoder" } are not used.

  bst.update(dtrain, iteration=i, fobj=obj)


Target distribution:
Target
1    129
0    121
Name: count, dtype: int64
Class balance: 51.60% positive (price increase)

Missing values before handling:
SMA_10              9
SMA_20             19
SMA_50             49
RSI                13
MACD               25
MACD_signal        33
MACD_diff          33
Price_change        1
Volume_change       1
SMA_10_20_cross    19
SMA_20_50_cross    49
news_count         49
dtype: int64
Dropped 86 rows with missing values
Missing values after handling: 0
   NFLX: Train=100.0%, Test=54.5%, Gap=45.5%
Successfully fetched 251 days of data for NVDA
   üìä Found 513 articles (505 direct + 307 keyword)
   ü§ñ Calculating sentiment...
   ‚úÖ Processed 513 articles with sentiment
Fetching politician trading data for NVDA...
Successfully fetched 581 politician trades for NVDA
Date range: 2016-01-20 to 2025-11-03

Transaction type breakdown:
transaction_type
purchase          325
sale              227
sale (full)        16
sale (partial)     10
exchange            3
Name: count, dtype: int64
Creating SMA indicators...
Creating RSI indicator...
Creating MACD indicators...
Merging sentiment data...
Merging politician trade data...
Creating advanced politician features...
üèõÔ∏è  Creating advanced politician features...
   ‚úÖ Net position indicators: net_trade_index, net_dollar_flow, buy_percentage
   ‚úÖ Temporal features: 3 rolling windows + momentum
   ‚úÖ Recency indicator: days_since_last_trade
   ‚úÖ Quality metrics: conviction_score
   ‚úÖ Added 23 advanced politician features
      ‚úÖ Added 23 advanced politician features
Creating target variable...

Feature engineering complete!
Features shape: (250, 41)
Target shape: (250,)
Features: ['SMA_10', 'SMA_20', 'SMA_50', 'RSI', 'MACD', 'MACD_signal', 'MACD_diff', 'Price_change', 'Volume_change', 'HL_spread', 'SMA_10_20_cross', 'SMA_20_50_cross', 'avg_sentiment_compound', 'avg_sentiment_positive', 'avg_sentiment_negative', 'news_count', 'politician_buy_count', 'politician_trade_amount', 'buy_count', 'sell_count', 'full_sale_count', 'partial_sale_count', 'total_amount', 'buy_amount', 'sell_amount', 'net_trade_index', 'net_dollar_flow', 'buy_percentage', 'trades_last_30d', 'amount_last_30d', 'net_flow_last_30d', 'trades_last_60d', 'amount_last_60d', 'net_flow_last_60d', 'trades_last_90d', 'amount_last_90d', 'net_flow_last_90d', 'trade_momentum_30d', 'dollar_momentum_30d', 'days_since_last_trade', 'conviction_score']

Target distribution:
Target
1    136
0    114
Name: count, dtype: int64
Class balance: 54.40% positive (price increase)

Missing values before handling:
SMA_10              9
SMA_20             19
SMA_50             49
RSI                13
MACD               25
MACD_signal        33
MACD_diff          33
Price_change        1
Volume_change       1
SMA_10_20_cross    19
SMA_20_50_cross    49
news_count         74
dtype: int64
Dropped 105 rows with missing values
Missing values after handling: 0
   NVDA: Train=100.0%, Test=51.7%, Gap=48.3%
Successfully fetched 251 days of data for BABA
   üìä Found 450 articles (444 direct + 333 keyword)
   ü§ñ Calculating sentiment...
   ‚úÖ Processed 450 articles with sentiment
Fetching politician trading data for BABA...
Successfully fetched 238 politician trades for BABA
Date range: 2014-10-16 to 2025-10-05

Transaction type breakdown:
transaction_type
purchase          126
sale               98
sale (full)        13
sale (partial)      1
Name: count, dtype: int64
Creating SMA indicators...
Creating RSI indicator...
Creating MACD indicators...
Merging sentiment data...
Merging politician trade data...
Creating advanced politician features...
üèõÔ∏è  Creating advanced politician features...
   ‚úÖ Net position indicators: net_trade_index, net_dollar_flow, buy_percentage
   ‚úÖ Temporal features: 3 rolling windows + momentum
   ‚úÖ Recency indicator: days_since_last_trade
   ‚úÖ Quality metrics: conviction_score
   ‚úÖ Added 23 advanced politician features
      ‚úÖ Added 23 advanced politician features
Creating target variable...

Feature engineering complete!
Features shape: (250, 41)
Target shape: (250,)
Features: ['SMA_10', 'SMA_20', 'SMA_50', 'RSI', 'MACD', 'MACD_signal', 'MACD_diff', 'Price_change', 'Volume_change', 'HL_spread', 'SMA_10_20_cross', 'SMA_20_50_cross', 'avg_sentiment_compound', 'avg_sentiment_positive', 'avg_sentiment_negative', 'news_count', 'politician_buy_count', 'politician_trade_amount', 'buy_count', 'sell_count', 'full_sale_count', 'partial_sale_count', 'total_amount', 'buy_amount', 'sell_amount', 'net_trade_index', 'net_dollar_flow', 'buy_percentage', 'trades_last_30d', 'amount_last_30d', 'net_flow_last_30d', 'trades_last_60d', 'amount_last_60d', 'net_flow_last_60d', 'trades_last_90d', 'amount_last_90d', 'net_flow_last_90d', 'trade_momentum_30d', 'dollar_momentum_30d', 'days_since_last_trade', 'conviction_score']

Target distribution:
Target
1    141
0    109
Name: count, dtype: int64
Class balance: 56.40% positive (price increase)

Missing values before handling:
SMA_10              9
SMA_20             19
SMA_50             49
RSI                13
MACD               25
MACD_signal        33
MACD_diff          33
Price_change        1
Volume_change       1
SMA_10_20_cross    19
SMA_20_50_cross    49
news_count         61
dtype: int64
Dropped 97 rows with missing values
Missing values after handling: 0
   BABA: Train=100.0%, Test=71.0%, Gap=29.0%
   üìä Average: Train=100.0%, Test=59.1%, Gap=40.9%

[4/13] Testing: Alpha=0.1
--------------------------------------------------------------------------------
Successfully fetched 251 days of data for NFLX
   üìä Found 803 articles (798 direct + 636 keyword)
   ü§ñ Calculating sentiment...
   ‚úÖ Processed 803 articles with sentiment
Fetching politician trading data for NFLX...
Successfully fetched 373 politician trades for NFLX
Date range: 2014-04-03 to 2025-10-28

Transaction type breakdown:
transaction_type
purchase          194
sale              144
sale (full)        31
sale (partial)      3
exchange            1
Name: count, dtype: int64
Creating SMA indicators...
Creating RSI indicator...
Creating MACD indicators...
Merging sentiment data...
Merging politician trade data...
Creating advanced politician features...
üèõÔ∏è  Creating advanced politician features...
   ‚úÖ Net position indicators: net_trade_index, net_dollar_flow, buy_percentage
   ‚úÖ Temporal features: 3 rolling windows + momentum
   ‚úÖ Recency indicator: days_since_last_trade
   ‚úÖ Quality metrics: conviction_score
   ‚úÖ Added 23 advanced politician features
      ‚úÖ Added 23 advanced politician features
Creating target variable...

Feature engineering complete!
Features shape: (250, 41)
Target shape: (250,)
Features: ['SMA_10', 'SMA_20', 'SMA_50', 'RSI', 'MACD', 'MACD_signal', 'MACD_diff', 'Price_change', 'Volume_change', 'HL_spread', 'SMA_10_20_cross', 'SMA_20_50_cross', 'avg_sentiment_compound', 'avg_sentiment_positive', 'avg_sentiment_negative', 'news_count', 'politician_buy_count', 'politician_trade_amount', 'buy_count', 'sell_count', 'full_sale_count', 'partial_sale_count', 'total_amount', 'buy_amount', 'sell_amount', 'net_trade_index', 'net_dollar_flow', 'buy_percentage', 'trades_last_30d', 'amount_last_30d', 'net_flow_last_30d', 'trades_last_60d', 'amount_last_60d', 'net_flow_last_60d', 'trades_last_90d', 'amount_last_90d', 'net_flow_last_90d', 'trade_momentum_30d', 'dollar_momentum_30d', 'days_since_last_trade', 'conviction_score']

Target distribution:
Target
1    129
0    121
Name: count, dtype: int64
Class balance: 51.60% positive (price increase)

Missing values before handling:
SMA_10              9
SMA_20             19
SMA_50             49
RSI                13
MACD               25
MACD_signal        33
MACD_diff          33
Price_change        1
Volume_change       1
SMA_10_20_cross    19
SMA_20_50_cross    49
news_count         49
dtype: int64
Dropped 86 rows with missing values
Missing values after handling: 0
   NFLX: Train=100.0%, Test=54.5%, Gap=45.5%
Successfully fetched 251 days of data for NVDA
   üìä Found 513 articles (505 direct + 307 keyword)
   ü§ñ Calculating sentiment...
   ‚úÖ Processed 513 articles with sentiment
Fetching politician trading data for NVDA.../Users/tobycoleman/mining/StockPrediction/venv/lib/python3.13/site-packages/xgboost/training.py:199: UserWarning: [14:54:01] WARNING: /Users/runner/work/xgboost/xgboost/src/learner.cc:790: 
Parameters: { "use_label_encoder" } are not used.

  bst.update(dtrain, iteration=i, fobj=obj)
/Users/tobycoleman/mining/StockPrediction/venv/lib/python3.13/site-packages/xgboost/training.py:199: UserWarning: [14:54:01] WARNING: /Users/runner/work/xgboost/xgboost/src/learner.cc:790: 
Parameters: { "use_label_encoder" } are not used.

  bst.update(dtrain, iteration=i, fobj=obj)
/Users/tobycoleman/mining/StockPrediction/venv/lib/python3.13/site-packages/xgboost/training.py:199: UserWarning: [14:54:02] WARNING: /Users/runner/work/xgboost/xgboost/src/learner.cc:790: 
Parameters: { "use_label_encoder" } are not used.

  bst.update(dtrain, iteration=i, fobj=obj)

Successfully fetched 581 politician trades for NVDA
Date range: 2016-01-20 to 2025-11-03

Transaction type breakdown:
transaction_type
purchase          325
sale              227
sale (full)        16
sale (partial)     10
exchange            3
Name: count, dtype: int64
Creating SMA indicators...
Creating RSI indicator...
Creating MACD indicators...
Merging sentiment data...
Merging politician trade data...
Creating advanced politician features...
üèõÔ∏è  Creating advanced politician features...
   ‚úÖ Net position indicators: net_trade_index, net_dollar_flow, buy_percentage
   ‚úÖ Temporal features: 3 rolling windows + momentum
   ‚úÖ Recency indicator: days_since_last_trade
   ‚úÖ Quality metrics: conviction_score
   ‚úÖ Added 23 advanced politician features
      ‚úÖ Added 23 advanced politician features
Creating target variable...

Feature engineering complete!
Features shape: (250, 41)
Target shape: (250,)
Features: ['SMA_10', 'SMA_20', 'SMA_50', 'RSI', 'MACD', 'MACD_signal', 'MACD_diff', 'Price_change', 'Volume_change', 'HL_spread', 'SMA_10_20_cross', 'SMA_20_50_cross', 'avg_sentiment_compound', 'avg_sentiment_positive', 'avg_sentiment_negative', 'news_count', 'politician_buy_count', 'politician_trade_amount', 'buy_count', 'sell_count', 'full_sale_count', 'partial_sale_count', 'total_amount', 'buy_amount', 'sell_amount', 'net_trade_index', 'net_dollar_flow', 'buy_percentage', 'trades_last_30d', 'amount_last_30d', 'net_flow_last_30d', 'trades_last_60d', 'amount_last_60d', 'net_flow_last_60d', 'trades_last_90d', 'amount_last_90d', 'net_flow_last_90d', 'trade_momentum_30d', 'dollar_momentum_30d', 'days_since_last_trade', 'conviction_score']

Target distribution:
Target
1    136
0    114
Name: count, dtype: int64
Class balance: 54.40% positive (price increase)

Missing values before handling:
SMA_10              9
SMA_20             19
SMA_50             49
RSI                13
MACD               25
MACD_signal        33
MACD_diff          33
Price_change        1
Volume_change       1
SMA_10_20_cross    19
SMA_20_50_cross    49
news_count         74
dtype: int64
Dropped 105 rows with missing values
Missing values after handling: 0
   NVDA: Train=100.0%, Test=44.8%, Gap=55.2%
Successfully fetched 251 days of data for BABA
   üìä Found 450 articles (444 direct + 333 keyword)
   ü§ñ Calculating sentiment...
   ‚úÖ Processed 450 articles with sentiment
Fetching politician trading data for BABA...
Successfully fetched 238 politician trades for BABA
Date range: 2014-10-16 to 2025-10-05

Transaction type breakdown:
transaction_type
purchase          126
sale               98
sale (full)        13
sale (partial)      1
Name: count, dtype: int64
Creating SMA indicators...
Creating RSI indicator...
Creating MACD indicators...
Merging sentiment data...
Merging politician trade data...
Creating advanced politician features...
üèõÔ∏è  Creating advanced politician features...
   ‚úÖ Net position indicators: net_trade_index, net_dollar_flow, buy_percentage
   ‚úÖ Temporal features: 3 rolling windows + momentum
   ‚úÖ Recency indicator: days_since_last_trade
   ‚úÖ Quality metrics: conviction_score
   ‚úÖ Added 23 advanced politician features
      ‚úÖ Added 23 advanced politician features
Creating target variable...

Feature engineering complete!
Features shape: (250, 41)
Target shape: (250,)
Features: ['SMA_10', 'SMA_20', 'SMA_50', 'RSI', 'MACD', 'MACD_signal', 'MACD_diff', 'Price_change', 'Volume_change', 'HL_spread', 'SMA_10_20_cross', 'SMA_20_50_cross', 'avg_sentiment_compound', 'avg_sentiment_positive', 'avg_sentiment_negative', 'news_count', 'politician_buy_count', 'politician_trade_amount', 'buy_count', 'sell_count', 'full_sale_count', 'partial_sale_count', 'total_amount', 'buy_amount', 'sell_amount', 'net_trade_index', 'net_dollar_flow', 'buy_percentage', 'trades_last_30d', 'amount_last_30d', 'net_flow_last_30d', 'trades_last_60d', 'amount_last_60d', 'net_flow_last_60d', 'trades_last_90d', 'amount_last_90d', 'net_flow_last_90d', 'trade_momentum_30d', 'dollar_momentum_30d', 'days_since_last_trade', 'conviction_score']

Target distribution:
Target
1    141
0    109
Name: count, dtype: int64
Class balance: 56.40% positive (price increase)

Missing values before handling:
SMA_10              9
SMA_20             19
SMA_50             49
RSI                13
MACD               25
MACD_signal        33
MACD_diff          33
Price_change        1
Volume_change       1
SMA_10_20_cross    19
SMA_20_50_cross    49
news_count         61
dtype: int64
Dropped 97 rows with missing values
Missing values after handling: 0
   BABA: Train=100.0%, Test=64.5%, Gap=35.5%
   üìä Average: Train=100.0%, Test=54.6%, Gap=45.4%

[5/13] Testing: Alpha=1.0
--------------------------------------------------------------------------------
Successfully fetched 251 days of data for NFLX
   üìä Found 803 articles (798 direct + 636 keyword)
   ü§ñ Calculating sentiment...
   ‚úÖ Processed 803 articles with sentiment
Fetching politician trading data for NFLX...
Successfully fetched 373 politician trades for NFLX
Date range: 2014-04-03 to 2025-10-28

Transaction type breakdown:
transaction_type
purchase          194
sale              144
sale (full)        31
sale (partial)      3
exchange            1
Name: count, dtype: int64
Creating SMA indicators...
Creating RSI indicator...
Creating MACD indicators...
Merging sentiment data...
Merging politician trade data...
Creating advanced politician features...
üèõÔ∏è  Creating advanced politician features...
   ‚úÖ Net position indicators: net_trade_index, net_dollar_flow, buy_percentage
   ‚úÖ Temporal features: 3 rolling windows + momentum
   ‚úÖ Recency indicator: days_since_last_trade
   ‚úÖ Quality metrics: conviction_score
   ‚úÖ Added 23 advanced politician features
      ‚úÖ Added 23 advanced politician features
Creating target variable...

Feature engineering complete!
Features shape: (250, 41)
Target shape: (250,)
Features: ['SMA_10', 'SMA_20', 'SMA_50', 'RSI', 'MACD', 'MACD_signal', 'MACD_diff', 'Price_change', 'Volume_change', 'HL_spread', 'SMA_10_20_cross', 'SMA_20_50_cross', 'avg_sentiment_compound', 'avg_sentiment_positive', 'avg_sentiment_negative', 'news_count', 'politician_buy_count', 'politician_trade_amount', 'buy_count', 'sell_count', 'full_sale_count', 'partial_sale_count', 'total_amount', 'buy_amount', 'sell_amount', 'net_trade_index', 'net_dollar_flow', 'buy_percentage', 'trades_last_30d', 'amount_last_30d', 'net_flow_last_30d', 'trades_last_60d', 'amount_last_60d', 'net_flow_last_60d', 'trades_last_90d', 'amount_last_90d', 'net_flow_last_90d', 'trade_momentum_30d', 'dollar_momentum_30d', 'days_since_last_trade', 'conviction_score']

Target distribution:
Target
1    129
0    121
Name: count, dtype: int64
Class balance: 51.60% positive (price increase)

Missing values before handling:
SMA_10              9
SMA_20             19
SMA_50             49
RSI                13
MACD               25
MACD_signal        33
MACD_diff          33
Price_change        1
Volume_change       1
SMA_10_20_cross    19
SMA_20_50_cross    49
news_count         49
dtype: int64
Dropped 86 rows with missing values
Missing values after handling: 0
   NFLX: Train=100.0%, Test=72.7%, Gap=27.3%
Successfully fetched 251 days of data for NVDA
   üìä Found 513 articles (505 direct + 307 keyword)
   ü§ñ Calculating sentiment...
   ‚úÖ Processed 513 articles with sentiment
Fetching politician trading data for NVDA...
Successfully fetched 581 politician trades for NVDA
Date range: 2016-01-20 to 2025-11-03

Transaction type breakdown:
transaction_type
purchase          325
sale              227
sale (full)        16
sale (partial)     10
exchange            3
Name: count, dtype: int64
Creating SMA indicators...
Creating RSI indicator...
Creating MACD indicators...
Merging sentiment data...
Merging politician trade data...
Creating advanced politician features...
üèõÔ∏è  Creating advanced politician features...
   ‚úÖ Net position indicators: net_trade_index, net_dollar_flow, buy_percentage
   ‚úÖ Temporal features: 3 rolling windows + momentum
   ‚úÖ Recency indicator: days_since_last_trade
   ‚úÖ Quality metrics: conviction_score/Users/tobycoleman/mining/StockPrediction/venv/lib/python3.13/site-packages/xgboost/training.py:199: UserWarning: [14:54:03] WARNING: /Users/runner/work/xgboost/xgboost/src/learner.cc:790: 
Parameters: { "use_label_encoder" } are not used.

  bst.update(dtrain, iteration=i, fobj=obj)
/Users/tobycoleman/mining/StockPrediction/venv/lib/python3.13/site-packages/xgboost/training.py:199: UserWarning: [14:54:03] WARNING: /Users/runner/work/xgboost/xgboost/src/learner.cc:790: 
Parameters: { "use_label_encoder" } are not used.

  bst.update(dtrain, iteration=i, fobj=obj)
/Users/tobycoleman/mining/StockPrediction/venv/lib/python3.13/site-packages/xgboost/training.py:199: UserWarning: [14:54:04] WARNING: /Users/runner/work/xgboost/xgboost/src/learner.cc:790: 
Parameters: { "use_label_encoder" } are not used.

  bst.update(dtrain, iteration=i, fobj=obj)
/Users/tobycoleman/mining/StockPrediction/venv/lib/python3.13/site-packages/xgboost/training.py:199: UserWarning: [14:54:04] WARNING: /Users/runner/work/xgboost/xgboost/src/learner.cc:790: 
Parameters: { "use_label_encoder" } are not used.

  bst.update(dtrain, iteration=i, fobj=obj)

   ‚úÖ Added 23 advanced politician features
      ‚úÖ Added 23 advanced politician features
Creating target variable...

Feature engineering complete!
Features shape: (250, 41)
Target shape: (250,)
Features: ['SMA_10', 'SMA_20', 'SMA_50', 'RSI', 'MACD', 'MACD_signal', 'MACD_diff', 'Price_change', 'Volume_change', 'HL_spread', 'SMA_10_20_cross', 'SMA_20_50_cross', 'avg_sentiment_compound', 'avg_sentiment_positive', 'avg_sentiment_negative', 'news_count', 'politician_buy_count', 'politician_trade_amount', 'buy_count', 'sell_count', 'full_sale_count', 'partial_sale_count', 'total_amount', 'buy_amount', 'sell_amount', 'net_trade_index', 'net_dollar_flow', 'buy_percentage', 'trades_last_30d', 'amount_last_30d', 'net_flow_last_30d', 'trades_last_60d', 'amount_last_60d', 'net_flow_last_60d', 'trades_last_90d', 'amount_last_90d', 'net_flow_last_90d', 'trade_momentum_30d', 'dollar_momentum_30d', 'days_since_last_trade', 'conviction_score']

Target distribution:
Target
1    136
0    114
Name: count, dtype: int64
Class balance: 54.40% positive (price increase)

Missing values before handling:
SMA_10              9
SMA_20             19
SMA_50             49
RSI                13
MACD               25
MACD_signal        33
MACD_diff          33
Price_change        1
Volume_change       1
SMA_10_20_cross    19
SMA_20_50_cross    49
news_count         74
dtype: int64
Dropped 105 rows with missing values
Missing values after handling: 0
   NVDA: Train=100.0%, Test=55.2%, Gap=44.8%
Successfully fetched 251 days of data for BABA
   üìä Found 450 articles (444 direct + 333 keyword)
   ü§ñ Calculating sentiment...
   ‚úÖ Processed 450 articles with sentiment
Fetching politician trading data for BABA...
Successfully fetched 238 politician trades for BABA
Date range: 2014-10-16 to 2025-10-05

Transaction type breakdown:
transaction_type
purchase          126
sale               98
sale (full)        13
sale (partial)      1
Name: count, dtype: int64
Creating SMA indicators...
Creating RSI indicator...
Creating MACD indicators...
Merging sentiment data...
Merging politician trade data...
Creating advanced politician features...
üèõÔ∏è  Creating advanced politician features...
   ‚úÖ Net position indicators: net_trade_index, net_dollar_flow, buy_percentage
   ‚úÖ Temporal features: 3 rolling windows + momentum
   ‚úÖ Recency indicator: days_since_last_trade
   ‚úÖ Quality metrics: conviction_score
   ‚úÖ Added 23 advanced politician features
      ‚úÖ Added 23 advanced politician features
Creating target variable...

Feature engineering complete!
Features shape: (250, 41)
Target shape: (250,)
Features: ['SMA_10', 'SMA_20', 'SMA_50', 'RSI', 'MACD', 'MACD_signal', 'MACD_diff', 'Price_change', 'Volume_change', 'HL_spread', 'SMA_10_20_cross', 'SMA_20_50_cross', 'avg_sentiment_compound', 'avg_sentiment_positive', 'avg_sentiment_negative', 'news_count', 'politician_buy_count', 'politician_trade_amount', 'buy_count', 'sell_count', 'full_sale_count', 'partial_sale_count', 'total_amount', 'buy_amount', 'sell_amount', 'net_trade_index', 'net_dollar_flow', 'buy_percentage', 'trades_last_30d', 'amount_last_30d', 'net_flow_last_30d', 'trades_last_60d', 'amount_last_60d', 'net_flow_last_60d', 'trades_last_90d', 'amount_last_90d', 'net_flow_last_90d', 'trade_momentum_30d', 'dollar_momentum_30d', 'days_since_last_trade', 'conviction_score']

Target distribution:
Target
1    141
0    109
Name: count, dtype: int64
Class balance: 56.40% positive (price increase)

Missing values before handling:
SMA_10              9
SMA_20             19
SMA_50             49
RSI                13
MACD               25
MACD_signal        33
MACD_diff          33
Price_change        1
Volume_change       1
SMA_10_20_cross    19
SMA_20_50_cross    49
news_count         61
dtype: int64
Dropped 97 rows with missing values
Missing values after handling: 0
   BABA: Train=100.0%, Test=74.2%, Gap=25.8%
   üìä Average: Train=100.0%, Test=67.4%, Gap=32.6%

[6/13] Testing: Lambda=5
--------------------------------------------------------------------------------
Successfully fetched 251 days of data for NFLX
   üìä Found 803 articles (798 direct + 636 keyword)
   ü§ñ Calculating sentiment...
   ‚úÖ Processed 803 articles with sentiment
Fetching politician trading data for NFLX...
Successfully fetched 373 politician trades for NFLX
Date range: 2014-04-03 to 2025-10-28

Transaction type breakdown:
transaction_type
purchase          194
sale              144
sale (full)        31
sale (partial)      3
exchange            1
Name: count, dtype: int64
Creating SMA indicators...
Creating RSI indicator...
Creating MACD indicators...
Merging sentiment data...
Merging politician trade data...
Creating advanced politician features...
üèõÔ∏è  Creating advanced politician features...
   ‚úÖ Net position indicators: net_trade_index, net_dollar_flow, buy_percentage
   ‚úÖ Temporal features: 3 rolling windows + momentum
   ‚úÖ Recency indicator: days_since_last_trade
   ‚úÖ Quality metrics: conviction_score
   ‚úÖ Added 23 advanced politician features
      ‚úÖ Added 23 advanced politician features
Creating target variable...

Feature engineering complete!
Features shape: (250, 41)
Target shape: (250,)
Features: ['SMA_10', 'SMA_20', 'SMA_50', 'RSI', 'MACD', 'MACD_signal', 'MACD_diff', 'Price_change', 'Volume_change', 'HL_spread', 'SMA_10_20_cross', 'SMA_20_50_cross', 'avg_sentiment_compound', 'avg_sentiment_positive', 'avg_sentiment_negative', 'news_count', 'politician_buy_count', 'politician_trade_amount', 'buy_count', 'sell_count', 'full_sale_count', 'partial_sale_count', 'total_amount', 'buy_amount', 'sell_amount', 'net_trade_index', 'net_dollar_flow', 'buy_percentage', 'trades_last_30d', 'amount_last_30d', 'net_flow_last_30d', 'trades_last_60d', 'amount_last_60d', 'net_flow_last_60d', 'trades_last_90d', 'amount_last_90d', 'net_flow_last_90d', 'trade_momentum_30d', 'dollar_momentum_30d', 'days_since_last_trade', 'conviction_score']

Target distribution:
Target
1    129
0    121
Name: count, dtype: int64
Class balance: 51.60% positive (price increase)

Missing values before handling:
SMA_10              9
SMA_20             19
SMA_50             49
RSI                13
MACD               25
MACD_signal        33
MACD_diff          33
Price_change        1
Volume_change       1
SMA_10_20_cross    19
SMA_20_50_cross    49
news_count         49
dtype: int64
Dropped 86 rows with missing values
Missing values after handling: 0
   NFLX: Train=100.0%, Test=51.5%, Gap=48.5%
Successfully fetched 251 days of data for NVDA
   üìä Found 513 articles (505 direct + 307 keyword)
   ü§ñ Calculating sentiment...
   ‚úÖ Processed 513 articles with sentiment
Fetching politician trading data for NVDA...
Successfully fetched 581 politician trades for NVDA
Date range: 2016-01-20 to 2025-11-03

Transaction type breakdown:
transaction_type
purchase          325
sale              227
sale (full)        16
sale (partial)     10
exchange            3
Name: count, dtype: int64
Creating SMA indicators...
Creating RSI indicator...
Creating MACD indicators...
Merging sentiment data...
Merging politician trade data...
Creating advanced politician features...
üèõÔ∏è  Creating advanced politician features...
   ‚úÖ Net position indicators: net_trade_index, net_dollar_flow, buy_percentage
   ‚úÖ Temporal features: 3 rolling windows + momentum
   ‚úÖ Recency indicator: days_since_last_trade
   ‚úÖ Quality metrics: conviction_score
   ‚úÖ Added 23 advanced politician features
      ‚úÖ Added 23 advanced politician features
Creating target variable...

Feature engineering complete!
Features shape: (250, 41)
Target shape: (250,)
Features: ['SMA_10', 'SMA_20', 'SMA_50', 'RSI', 'MACD', 'MACD_signal', 'MACD_diff', 'Price_change', 'Volume_change', 'HL_spread', 'SMA_10_20_cross', 'SMA_20_50_cross', 'avg_sentiment_compound', 'avg_sentiment_positive', 'avg_sentiment_negative', 'news_count', 'politician_buy_count', 'politician_trade_amount', 'buy_count', 'sell_count', 'full_sale_count', 'partial_sale_count', 'total_amount', 'buy_amount', 'sell_amount', 'net_trade_index', 'net_dollar_flow', 'buy_percentage', 'trades_last_30d', 'amount_last_30d', 'net_flow_last_30d', 'trades_last_60d', 'amount_last_60d', 'net_flow_last_60d', 'trades_last_90d', 'amount_last_90d', 'net_flow_last_90d', 'trade_momentum_30d', 'dollar_momentum_30d', 'days_since_last_trade', 'conviction_score']/Users/tobycoleman/mining/StockPrediction/venv/lib/python3.13/site-packages/xgboost/training.py:199: UserWarning: [14:54:05] WARNING: /Users/runner/work/xgboost/xgboost/src/learner.cc:790: 
Parameters: { "use_label_encoder" } are not used.

  bst.update(dtrain, iteration=i, fobj=obj)
/Users/tobycoleman/mining/StockPrediction/venv/lib/python3.13/site-packages/xgboost/training.py:199: UserWarning: [14:54:06] WARNING: /Users/runner/work/xgboost/xgboost/src/learner.cc:790: 
Parameters: { "use_label_encoder" } are not used.

  bst.update(dtrain, iteration=i, fobj=obj)
/Users/tobycoleman/mining/StockPrediction/venv/lib/python3.13/site-packages/xgboost/training.py:199: UserWarning: [14:54:06] WARNING: /Users/runner/work/xgboost/xgboost/src/learner.cc:790: 
Parameters: { "use_label_encoder" } are not used.

  bst.update(dtrain, iteration=i, fobj=obj)


Target distribution:
Target
1    136
0    114
Name: count, dtype: int64
Class balance: 54.40% positive (price increase)

Missing values before handling:
SMA_10              9
SMA_20             19
SMA_50             49
RSI                13
MACD               25
MACD_signal        33
MACD_diff          33
Price_change        1
Volume_change       1
SMA_10_20_cross    19
SMA_20_50_cross    49
news_count         74
dtype: int64
Dropped 105 rows with missing values
Missing values after handling: 0
   NVDA: Train=100.0%, Test=44.8%, Gap=55.2%
Successfully fetched 251 days of data for BABA
   üìä Found 450 articles (444 direct + 333 keyword)
   ü§ñ Calculating sentiment...
   ‚úÖ Processed 450 articles with sentiment
Fetching politician trading data for BABA...
Successfully fetched 238 politician trades for BABA
Date range: 2014-10-16 to 2025-10-05

Transaction type breakdown:
transaction_type
purchase          126
sale               98
sale (full)        13
sale (partial)      1
Name: count, dtype: int64
Creating SMA indicators...
Creating RSI indicator...
Creating MACD indicators...
Merging sentiment data...
Merging politician trade data...
Creating advanced politician features...
üèõÔ∏è  Creating advanced politician features...
   ‚úÖ Net position indicators: net_trade_index, net_dollar_flow, buy_percentage
   ‚úÖ Temporal features: 3 rolling windows + momentum
   ‚úÖ Recency indicator: days_since_last_trade
   ‚úÖ Quality metrics: conviction_score
   ‚úÖ Added 23 advanced politician features
      ‚úÖ Added 23 advanced politician features
Creating target variable...

Feature engineering complete!
Features shape: (250, 41)
Target shape: (250,)
Features: ['SMA_10', 'SMA_20', 'SMA_50', 'RSI', 'MACD', 'MACD_signal', 'MACD_diff', 'Price_change', 'Volume_change', 'HL_spread', 'SMA_10_20_cross', 'SMA_20_50_cross', 'avg_sentiment_compound', 'avg_sentiment_positive', 'avg_sentiment_negative', 'news_count', 'politician_buy_count', 'politician_trade_amount', 'buy_count', 'sell_count', 'full_sale_count', 'partial_sale_count', 'total_amount', 'buy_amount', 'sell_amount', 'net_trade_index', 'net_dollar_flow', 'buy_percentage', 'trades_last_30d', 'amount_last_30d', 'net_flow_last_30d', 'trades_last_60d', 'amount_last_60d', 'net_flow_last_60d', 'trades_last_90d', 'amount_last_90d', 'net_flow_last_90d', 'trade_momentum_30d', 'dollar_momentum_30d', 'days_since_last_trade', 'conviction_score']

Target distribution:
Target
1    141
0    109
Name: count, dtype: int64
Class balance: 56.40% positive (price increase)

Missing values before handling:
SMA_10              9
SMA_20             19
SMA_50             49
RSI                13
MACD               25
MACD_signal        33
MACD_diff          33
Price_change        1
Volume_change       1
SMA_10_20_cross    19
SMA_20_50_cross    49
news_count         61
dtype: int64
Dropped 97 rows with missing values
Missing values after handling: 0
   BABA: Train=100.0%, Test=64.5%, Gap=35.5%
   üìä Average: Train=100.0%, Test=53.6%, Gap=46.4%

[7/13] Testing: Lambda=10
--------------------------------------------------------------------------------
Successfully fetched 251 days of data for NFLX
   üìä Found 803 articles (798 direct + 636 keyword)
   ü§ñ Calculating sentiment...
   ‚úÖ Processed 803 articles with sentiment
Fetching politician trading data for NFLX...
Successfully fetched 373 politician trades for NFLX
Date range: 2014-04-03 to 2025-10-28

Transaction type breakdown:
transaction_type
purchase          194
sale              144
sale (full)        31
sale (partial)      3
exchange            1
Name: count, dtype: int64
Creating SMA indicators...
Creating RSI indicator...
Creating MACD indicators...
Merging sentiment data...
Merging politician trade data...
Creating advanced politician features...
üèõÔ∏è  Creating advanced politician features...
   ‚úÖ Net position indicators: net_trade_index, net_dollar_flow, buy_percentage
   ‚úÖ Temporal features: 3 rolling windows + momentum
   ‚úÖ Recency indicator: days_since_last_trade
   ‚úÖ Quality metrics: conviction_score
   ‚úÖ Added 23 advanced politician features
      ‚úÖ Added 23 advanced politician features
Creating target variable...

Feature engineering complete!
Features shape: (250, 41)
Target shape: (250,)
Features: ['SMA_10', 'SMA_20', 'SMA_50', 'RSI', 'MACD', 'MACD_signal', 'MACD_diff', 'Price_change', 'Volume_change', 'HL_spread', 'SMA_10_20_cross', 'SMA_20_50_cross', 'avg_sentiment_compound', 'avg_sentiment_positive', 'avg_sentiment_negative', 'news_count', 'politician_buy_count', 'politician_trade_amount', 'buy_count', 'sell_count', 'full_sale_count', 'partial_sale_count', 'total_amount', 'buy_amount', 'sell_amount', 'net_trade_index', 'net_dollar_flow', 'buy_percentage', 'trades_last_30d', 'amount_last_30d', 'net_flow_last_30d', 'trades_last_60d', 'amount_last_60d', 'net_flow_last_60d', 'trades_last_90d', 'amount_last_90d', 'net_flow_last_90d', 'trade_momentum_30d', 'dollar_momentum_30d', 'days_since_last_trade', 'conviction_score']

Target distribution:
Target
1    129
0    121
Name: count, dtype: int64
Class balance: 51.60% positive (price increase)

Missing values before handling:
SMA_10              9
SMA_20             19
SMA_50             49
RSI                13
MACD               25
MACD_signal        33
MACD_diff          33
Price_change        1
Volume_change       1
SMA_10_20_cross    19
SMA_20_50_cross    49
news_count         49
dtype: int64
Dropped 86 rows with missing values
Missing values after handling: 0
   NFLX: Train=100.0%, Test=54.5%, Gap=45.5%
Successfully fetched 251 days of data for NVDA
   üìä Found 513 articles (505 direct + 307 keyword)
   ü§ñ Calculating sentiment...
   ‚úÖ Processed 513 articles with sentiment
Fetching politician trading data for NVDA...
Successfully fetched 581 politician trades for NVDA
Date range: 2016-01-20 to 2025-11-03

Transaction type breakdown:
transaction_type
purchase          325
sale              227
sale (full)        16
sale (partial)     10
exchange            3
Name: count, dtype: int64
Creating SMA indicators...
Creating RSI indicator...
Creating MACD indicators...
Merging sentiment data...
Merging politician trade data...
Creating advanced politician features...
üèõÔ∏è  Creating advanced politician features...
   ‚úÖ Net position indicators: net_trade_index, net_dollar_flow, buy_percentage
   ‚úÖ Temporal features: 3 rolling windows + momentum
   ‚úÖ Recency indicator: days_since_last_trade
   ‚úÖ Quality metrics: conviction_score
   ‚úÖ Added 23 advanced politician features
      ‚úÖ Added 23 advanced politician features
Creating target variable...

Feature engineering complete!
Features shape: (250, 41)
Target shape: (250,)
Features: ['SMA_10', 'SMA_20', 'SMA_50', 'RSI', 'MACD', 'MACD_signal', 'MACD_diff', 'Price_change', 'Volume_change', 'HL_spread', 'SMA_10_20_cross', 'SMA_20_50_cross', 'avg_sentiment_compound', 'avg_sentiment_positive', 'avg_sentiment_negative', 'news_count', 'politician_buy_count', 'politician_trade_amount', 'buy_count', 'sell_count', 'full_sale_count', 'partial_sale_count', 'total_amount', 'buy_amount', 'sell_amount', 'net_trade_index', 'net_dollar_flow', 'buy_percentage', 'trades_last_30d', 'amount_last_30d', 'net_flow_last_30d', 'trades_last_60d', 'amount_last_60d', 'net_flow_last_60d', 'trades_last_90d', 'amount_last_90d', 'net_flow_last_90d', 'trade_momentum_30d', 'dollar_momentum_30d', 'days_since_last_trade', 'conviction_score']

Target distribution:
Target
1    136
0    114
Name: count, dtype: int64
Class balance: 54.40% positive (price increase)

Missing values before handling:
SMA_10              9
SMA_20             19
SMA_50             49
RSI                13
MACD               25
MACD_signal        33
MACD_diff          33
Price_change        1
Volume_change       1
SMA_10_20_cross    19
SMA_20_50_cross    49
news_count         74
dtype: int64
Dropped 105 rows with missing values
Missing values after handling: 0
   NVDA: Train=100.0%, Test=44.8%, Gap=55.2%
Successfully fetched 251 days of data for BABA
   üìä Found 450 articles (444 direct + 333 keyword)
   ü§ñ Calculating sentiment...
   ‚úÖ Processed 450 articles with sentiment
/Users/tobycoleman/mining/StockPrediction/venv/lib/python3.13/site-packages/xgboost/training.py:199: UserWarning: [14:54:07] WARNING: /Users/runner/work/xgboost/xgboost/src/learner.cc:790: 
Parameters: { "use_label_encoder" } are not used.

  bst.update(dtrain, iteration=i, fobj=obj)
/Users/tobycoleman/mining/StockPrediction/venv/lib/python3.13/site-packages/xgboost/training.py:199: UserWarning: [14:54:07] WARNING: /Users/runner/work/xgboost/xgboost/src/learner.cc:790: 
Parameters: { "use_label_encoder" } are not used.

  bst.update(dtrain, iteration=i, fobj=obj)
/Users/tobycoleman/mining/StockPrediction/venv/lib/python3.13/site-packages/xgboost/training.py:199: UserWarning: [14:54:08] WARNING: /Users/runner/work/xgboost/xgboost/src/learner.cc:790: 
Parameters: { "use_label_encoder" } are not used.

  bst.update(dtrain, iteration=i, fobj=obj)
Fetching politician trading data for BABA...
Successfully fetched 238 politician trades for BABA
Date range: 2014-10-16 to 2025-10-05

Transaction type breakdown:
transaction_type
purchase          126
sale               98
sale (full)        13
sale (partial)      1
Name: count, dtype: int64
Creating SMA indicators...
Creating RSI indicator...
Creating MACD indicators...
Merging sentiment data...
Merging politician trade data...
Creating advanced politician features...
üèõÔ∏è  Creating advanced politician features...
   ‚úÖ Net position indicators: net_trade_index, net_dollar_flow, buy_percentage
   ‚úÖ Temporal features: 3 rolling windows + momentum
   ‚úÖ Recency indicator: days_since_last_trade
   ‚úÖ Quality metrics: conviction_score
   ‚úÖ Added 23 advanced politician features
      ‚úÖ Added 23 advanced politician features
Creating target variable...

Feature engineering complete!
Features shape: (250, 41)
Target shape: (250,)
Features: ['SMA_10', 'SMA_20', 'SMA_50', 'RSI', 'MACD', 'MACD_signal', 'MACD_diff', 'Price_change', 'Volume_change', 'HL_spread', 'SMA_10_20_cross', 'SMA_20_50_cross', 'avg_sentiment_compound', 'avg_sentiment_positive', 'avg_sentiment_negative', 'news_count', 'politician_buy_count', 'politician_trade_amount', 'buy_count', 'sell_count', 'full_sale_count', 'partial_sale_count', 'total_amount', 'buy_amount', 'sell_amount', 'net_trade_index', 'net_dollar_flow', 'buy_percentage', 'trades_last_30d', 'amount_last_30d', 'net_flow_last_30d', 'trades_last_60d', 'amount_last_60d', 'net_flow_last_60d', 'trades_last_90d', 'amount_last_90d', 'net_flow_last_90d', 'trade_momentum_30d', 'dollar_momentum_30d', 'days_since_last_trade', 'conviction_score']

Target distribution:
Target
1    141
0    109
Name: count, dtype: int64
Class balance: 56.40% positive (price increase)

Missing values before handling:
SMA_10              9
SMA_20             19
SMA_50             49
RSI                13
MACD               25
MACD_signal        33
MACD_diff          33
Price_change        1
Volume_change       1
SMA_10_20_cross    19
SMA_20_50_cross    49
news_count         61
dtype: int64
Dropped 97 rows with missing values
Missing values after handling: 0
   BABA: Train=100.0%, Test=54.8%, Gap=45.2%
   üìä Average: Train=100.0%, Test=51.4%, Gap=48.6%

[8/13] Testing: MinChild=3
--------------------------------------------------------------------------------
Successfully fetched 251 days of data for NFLX
   üìä Found 803 articles (798 direct + 636 keyword)
   ü§ñ Calculating sentiment...
   ‚úÖ Processed 803 articles with sentiment
Fetching politician trading data for NFLX...
Successfully fetched 373 politician trades for NFLX
Date range: 2014-04-03 to 2025-10-28

Transaction type breakdown:
transaction_type
purchase          194
sale              144
sale (full)        31
sale (partial)      3
exchange            1
Name: count, dtype: int64
Creating SMA indicators...
Creating RSI indicator...
Creating MACD indicators...
Merging sentiment data...
Merging politician trade data...
Creating advanced politician features...
üèõÔ∏è  Creating advanced politician features...
   ‚úÖ Net position indicators: net_trade_index, net_dollar_flow, buy_percentage
   ‚úÖ Temporal features: 3 rolling windows + momentum
   ‚úÖ Recency indicator: days_since_last_trade
   ‚úÖ Quality metrics: conviction_score
   ‚úÖ Added 23 advanced politician features
      ‚úÖ Added 23 advanced politician features
Creating target variable...

Feature engineering complete!
Features shape: (250, 41)
Target shape: (250,)
Features: ['SMA_10', 'SMA_20', 'SMA_50', 'RSI', 'MACD', 'MACD_signal', 'MACD_diff', 'Price_change', 'Volume_change', 'HL_spread', 'SMA_10_20_cross', 'SMA_20_50_cross', 'avg_sentiment_compound', 'avg_sentiment_positive', 'avg_sentiment_negative', 'news_count', 'politician_buy_count', 'politician_trade_amount', 'buy_count', 'sell_count', 'full_sale_count', 'partial_sale_count', 'total_amount', 'buy_amount', 'sell_amount', 'net_trade_index', 'net_dollar_flow', 'buy_percentage', 'trades_last_30d', 'amount_last_30d', 'net_flow_last_30d', 'trades_last_60d', 'amount_last_60d', 'net_flow_last_60d', 'trades_last_90d', 'amount_last_90d', 'net_flow_last_90d', 'trade_momentum_30d', 'dollar_momentum_30d', 'days_since_last_trade', 'conviction_score']

Target distribution:
Target
1    129
0    121
Name: count, dtype: int64
Class balance: 51.60% positive (price increase)

Missing values before handling:
SMA_10              9
SMA_20             19
SMA_50             49
RSI                13
MACD               25
MACD_signal        33
MACD_diff          33
Price_change        1
Volume_change       1
SMA_10_20_cross    19
SMA_20_50_cross    49
news_count         49
dtype: int64
Dropped 86 rows with missing values
Missing values after handling: 0
   NFLX: Train=100.0%, Test=63.6%, Gap=36.4%
Successfully fetched 251 days of data for NVDA
   üìä Found 513 articles (505 direct + 307 keyword)
   ü§ñ Calculating sentiment...
   ‚úÖ Processed 513 articles with sentiment
Fetching politician trading data for NVDA...
Successfully fetched 581 politician trades for NVDA
Date range: 2016-01-20 to 2025-11-03

Transaction type breakdown:
transaction_type
purchase          325
sale              227
sale (full)        16
sale (partial)     10
exchange            3
Name: count, dtype: int64
Creating SMA indicators...
Creating RSI indicator...
Creating MACD indicators...
Merging sentiment data...
Merging politician trade data...
Creating advanced politician features...
üèõÔ∏è  Creating advanced politician features...
   ‚úÖ Net position indicators: net_trade_index, net_dollar_flow, buy_percentage
   ‚úÖ Temporal features: 3 rolling windows + momentum
   ‚úÖ Recency indicator: days_since_last_trade
   ‚úÖ Quality metrics: conviction_score
   ‚úÖ Added 23 advanced politician features
      ‚úÖ Added 23 advanced politician features
Creating target variable...

Feature engineering complete!
Features shape: (250, 41)
Target shape: (250,)
Features: ['SMA_10', 'SMA_20', 'SMA_50', 'RSI', 'MACD', 'MACD_signal', 'MACD_diff', 'Price_change', 'Volume_change', 'HL_spread', 'SMA_10_20_cross', 'SMA_20_50_cross', 'avg_sentiment_compound', 'avg_sentiment_positive', 'avg_sentiment_negative', 'news_count', 'politician_buy_count', 'politician_trade_amount', 'buy_count', 'sell_count', 'full_sale_count', 'partial_sale_count', 'total_amount', 'buy_amount', 'sell_amount', 'net_trade_index', 'net_dollar_flow', 'buy_percentage', 'trades_last_30d', 'amount_last_30d', 'net_flow_last_30d', 'trades_last_60d', 'amount_last_60d', 'net_flow_last_60d', 'trades_last_90d', 'amount_last_90d', 'net_flow_last_90d', 'trade_momentum_30d', 'dollar_momentum_30d', 'days_since_last_trade', 'conviction_score']

Target distribution:
Target
1    136
0    114
Name: count, dtype: int64
Class balance: 54.40% positive (price increase)

Missing values before handling:
SMA_10              9
SMA_20             19
SMA_50             49
RSI                13
MACD               25
MACD_signal        33
MACD_diff          33
Price_change        1
Volume_change       1
SMA_10_20_cross    19
SMA_20_50_cross    49
news_count         74
dtype: int64
Dropped 105 rows with missing values
Missing values after handling: 0
   NVDA: Train=100.0%, Test=55.2%, Gap=44.8%
Successfully fetched 251 days of data for BABA
   üìä Found 450 articles (444 direct + 333 keyword)
   ü§ñ Calculating sentiment...
   ‚úÖ Processed 450 articles with sentiment
Fetching politician trading data for BABA...
Successfully fetched 238 politician trades for BABA
Date range: 2014-10-16 to 2025-10-05

Transaction type breakdown:
transaction_type
purchase          126
sale               98
sale (full)        13
sale (partial)      1
Name: count, dtype: int64
Creating SMA indicators...
Creating RSI indicator...
Creating MACD indicators...
Merging sentiment data...
Merging politician trade data...
Creating advanced politician features...
üèõÔ∏è  Creating advanced politician features...
   ‚úÖ Net position indicators: net_trade_index, net_dollar_flow, buy_percentage
   ‚úÖ Temporal features: 3 rolling windows + momentum
   ‚úÖ Recency indicator: days_since_last_trade
   ‚úÖ Quality metrics: conviction_score/Users/tobycoleman/mining/StockPrediction/venv/lib/python3.13/site-packages/xgboost/training.py:199: UserWarning: [14:54:08] WARNING: /Users/runner/work/xgboost/xgboost/src/learner.cc:790: 
Parameters: { "use_label_encoder" } are not used.

  bst.update(dtrain, iteration=i, fobj=obj)
/Users/tobycoleman/mining/StockPrediction/venv/lib/python3.13/site-packages/xgboost/training.py:199: UserWarning: [14:54:09] WARNING: /Users/runner/work/xgboost/xgboost/src/learner.cc:790: 
Parameters: { "use_label_encoder" } are not used.

  bst.update(dtrain, iteration=i, fobj=obj)
/Users/tobycoleman/mining/StockPrediction/venv/lib/python3.13/site-packages/xgboost/training.py:199: UserWarning: [14:54:09] WARNING: /Users/runner/work/xgboost/xgboost/src/learner.cc:790: 
Parameters: { "use_label_encoder" } are not used.

  bst.update(dtrain, iteration=i, fobj=obj)
/Users/tobycoleman/mining/StockPrediction/venv/lib/python3.13/site-packages/xgboost/training.py:199: UserWarning: [14:54:10] WARNING: /Users/runner/work/xgboost/xgboost/src/learner.cc:790: 
Parameters: { "use_label_encoder" } are not used.

  bst.update(dtrain, iteration=i, fobj=obj)

   ‚úÖ Added 23 advanced politician features
      ‚úÖ Added 23 advanced politician features
Creating target variable...

Feature engineering complete!
Features shape: (250, 41)
Target shape: (250,)
Features: ['SMA_10', 'SMA_20', 'SMA_50', 'RSI', 'MACD', 'MACD_signal', 'MACD_diff', 'Price_change', 'Volume_change', 'HL_spread', 'SMA_10_20_cross', 'SMA_20_50_cross', 'avg_sentiment_compound', 'avg_sentiment_positive', 'avg_sentiment_negative', 'news_count', 'politician_buy_count', 'politician_trade_amount', 'buy_count', 'sell_count', 'full_sale_count', 'partial_sale_count', 'total_amount', 'buy_amount', 'sell_amount', 'net_trade_index', 'net_dollar_flow', 'buy_percentage', 'trades_last_30d', 'amount_last_30d', 'net_flow_last_30d', 'trades_last_60d', 'amount_last_60d', 'net_flow_last_60d', 'trades_last_90d', 'amount_last_90d', 'net_flow_last_90d', 'trade_momentum_30d', 'dollar_momentum_30d', 'days_since_last_trade', 'conviction_score']

Target distribution:
Target
1    141
0    109
Name: count, dtype: int64
Class balance: 56.40% positive (price increase)

Missing values before handling:
SMA_10              9
SMA_20             19
SMA_50             49
RSI                13
MACD               25
MACD_signal        33
MACD_diff          33
Price_change        1
Volume_change       1
SMA_10_20_cross    19
SMA_20_50_cross    49
news_count         61
dtype: int64
Dropped 97 rows with missing values
Missing values after handling: 0
   BABA: Train=100.0%, Test=71.0%, Gap=29.0%
   üìä Average: Train=100.0%, Test=63.3%, Gap=36.7%

[9/13] Testing: MinChild=5
--------------------------------------------------------------------------------
Successfully fetched 251 days of data for NFLX
   üìä Found 803 articles (798 direct + 636 keyword)
   ü§ñ Calculating sentiment...
   ‚úÖ Processed 803 articles with sentiment
Fetching politician trading data for NFLX...
Successfully fetched 373 politician trades for NFLX
Date range: 2014-04-03 to 2025-10-28

Transaction type breakdown:
transaction_type
purchase          194
sale              144
sale (full)        31
sale (partial)      3
exchange            1
Name: count, dtype: int64
Creating SMA indicators...
Creating RSI indicator...
Creating MACD indicators...
Merging sentiment data...
Merging politician trade data...
Creating advanced politician features...
üèõÔ∏è  Creating advanced politician features...
   ‚úÖ Net position indicators: net_trade_index, net_dollar_flow, buy_percentage
   ‚úÖ Temporal features: 3 rolling windows + momentum
   ‚úÖ Recency indicator: days_since_last_trade
   ‚úÖ Quality metrics: conviction_score
   ‚úÖ Added 23 advanced politician features
      ‚úÖ Added 23 advanced politician features
Creating target variable...

Feature engineering complete!
Features shape: (250, 41)
Target shape: (250,)
Features: ['SMA_10', 'SMA_20', 'SMA_50', 'RSI', 'MACD', 'MACD_signal', 'MACD_diff', 'Price_change', 'Volume_change', 'HL_spread', 'SMA_10_20_cross', 'SMA_20_50_cross', 'avg_sentiment_compound', 'avg_sentiment_positive', 'avg_sentiment_negative', 'news_count', 'politician_buy_count', 'politician_trade_amount', 'buy_count', 'sell_count', 'full_sale_count', 'partial_sale_count', 'total_amount', 'buy_amount', 'sell_amount', 'net_trade_index', 'net_dollar_flow', 'buy_percentage', 'trades_last_30d', 'amount_last_30d', 'net_flow_last_30d', 'trades_last_60d', 'amount_last_60d', 'net_flow_last_60d', 'trades_last_90d', 'amount_last_90d', 'net_flow_last_90d', 'trade_momentum_30d', 'dollar_momentum_30d', 'days_since_last_trade', 'conviction_score']

Target distribution:
Target
1    129
0    121
Name: count, dtype: int64
Class balance: 51.60% positive (price increase)

Missing values before handling:
SMA_10              9
SMA_20             19
SMA_50             49
RSI                13
MACD               25
MACD_signal        33
MACD_diff          33
Price_change        1
Volume_change       1
SMA_10_20_cross    19
SMA_20_50_cross    49
news_count         49
dtype: int64
Dropped 86 rows with missing values
Missing values after handling: 0
   NFLX: Train=95.4%, Test=60.6%, Gap=34.8%
Successfully fetched 251 days of data for NVDA
   üìä Found 513 articles (505 direct + 307 keyword)
   ü§ñ Calculating sentiment...
   ‚úÖ Processed 513 articles with sentiment
Fetching politician trading data for NVDA...
Successfully fetched 581 politician trades for NVDA
Date range: 2016-01-20 to 2025-11-03

Transaction type breakdown:
transaction_type
purchase          325
sale              227
sale (full)        16
sale (partial)     10
exchange            3
Name: count, dtype: int64
Creating SMA indicators...
Creating RSI indicator...
Creating MACD indicators...
Merging sentiment data...
Merging politician trade data...
Creating advanced politician features...
üèõÔ∏è  Creating advanced politician features...
   ‚úÖ Net position indicators: net_trade_index, net_dollar_flow, buy_percentage
   ‚úÖ Temporal features: 3 rolling windows + momentum
   ‚úÖ Recency indicator: days_since_last_trade
   ‚úÖ Quality metrics: conviction_score
   ‚úÖ Added 23 advanced politician features
      ‚úÖ Added 23 advanced politician features
Creating target variable...

Feature engineering complete!
Features shape: (250, 41)
Target shape: (250,)
Features: ['SMA_10', 'SMA_20', 'SMA_50', 'RSI', 'MACD', 'MACD_signal', 'MACD_diff', 'Price_change', 'Volume_change', 'HL_spread', 'SMA_10_20_cross', 'SMA_20_50_cross', 'avg_sentiment_compound', 'avg_sentiment_positive', 'avg_sentiment_negative', 'news_count', 'politician_buy_count', 'politician_trade_amount', 'buy_count', 'sell_count', 'full_sale_count', 'partial_sale_count', 'total_amount', 'buy_amount', 'sell_amount', 'net_trade_index', 'net_dollar_flow', 'buy_percentage', 'trades_last_30d', 'amount_last_30d', 'net_flow_last_30d', 'trades_last_60d', 'amount_last_60d', 'net_flow_last_60d', 'trades_last_90d', 'amount_last_90d', 'net_flow_last_90d', 'trade_momentum_30d', 'dollar_momentum_30d', 'days_since_last_trade', 'conviction_score']

Target distribution:
Target
1    136
0    114
Name: count, dtype: int64
Class balance: 54.40% positive (price increase)

Missing values before handling:
SMA_10              9
SMA_20             19
SMA_50             49
RSI                13
MACD               25
MACD_signal        33
MACD_diff          33
Price_change        1
Volume_change       1
SMA_10_20_cross    19
SMA_20_50_cross    49
news_count         74
dtype: int64
Dropped 105 rows with missing values
Missing values after handling: 0
   NVDA: Train=94.0%, Test=55.2%, Gap=38.8%
Successfully fetched 251 days of data for BABA
   üìä Found 450 articles (444 direct + 333 keyword)
   ü§ñ Calculating sentiment...
   ‚úÖ Processed 450 articles with sentiment
Fetching politician trading data for BABA...
Successfully fetched 238 politician trades for BABA
Date range: 2014-10-16 to 2025-10-05

Transaction type breakdown:
transaction_type
purchase          126
sale               98
sale (full)        13
sale (partial)      1
Name: count, dtype: int64
Creating SMA indicators...
Creating RSI indicator...
Creating MACD indicators...
Merging sentiment data...
Merging politician trade data...
Creating advanced politician features...
üèõÔ∏è  Creating advanced politician features...
   ‚úÖ Net position indicators: net_trade_index, net_dollar_flow, buy_percentage
   ‚úÖ Temporal features: 3 rolling windows + momentum
   ‚úÖ Recency indicator: days_since_last_trade
   ‚úÖ Quality metrics: conviction_score
   ‚úÖ Added 23 advanced politician features
      ‚úÖ Added 23 advanced politician features
Creating target variable...

Feature engineering complete!
Features shape: (250, 41)
Target shape: (250,)
Features: ['SMA_10', 'SMA_20', 'SMA_50', 'RSI', 'MACD', 'MACD_signal', 'MACD_diff', 'Price_change', 'Volume_change', 'HL_spread', 'SMA_10_20_cross', 'SMA_20_50_cross', 'avg_sentiment_compound', 'avg_sentiment_positive', 'avg_sentiment_negative', 'news_count', 'politician_buy_count', 'politician_trade_amount', 'buy_count', 'sell_count', 'full_sale_count', 'partial_sale_count', 'total_amount', 'buy_amount', 'sell_amount', 'net_trade_index', 'net_dollar_flow', 'buy_percentage', 'trades_last_30d', 'amount_last_30d', 'net_flow_last_30d', 'trades_last_60d', 'amount_last_60d', 'net_flow_last_60d', 'trades_last_90d', 'amount_last_90d', 'net_flow_last_90d', 'trade_momentum_30d', 'dollar_momentum_30d', 'days_since_last_trade', 'conviction_score']/Users/tobycoleman/mining/StockPrediction/venv/lib/python3.13/site-packages/xgboost/training.py:199: UserWarning: [14:54:10] WARNING: /Users/runner/work/xgboost/xgboost/src/learner.cc:790: 
Parameters: { "use_label_encoder" } are not used.

  bst.update(dtrain, iteration=i, fobj=obj)
/Users/tobycoleman/mining/StockPrediction/venv/lib/python3.13/site-packages/xgboost/training.py:199: UserWarning: [14:54:11] WARNING: /Users/runner/work/xgboost/xgboost/src/learner.cc:790: 
Parameters: { "use_label_encoder" } are not used.

  bst.update(dtrain, iteration=i, fobj=obj)
/Users/tobycoleman/mining/StockPrediction/venv/lib/python3.13/site-packages/xgboost/training.py:199: UserWarning: [14:54:11] WARNING: /Users/runner/work/xgboost/xgboost/src/learner.cc:790: 
Parameters: { "use_label_encoder" } are not used.

  bst.update(dtrain, iteration=i, fobj=obj)


Target distribution:
Target
1    141
0    109
Name: count, dtype: int64
Class balance: 56.40% positive (price increase)

Missing values before handling:
SMA_10              9
SMA_20             19
SMA_50             49
RSI                13
MACD               25
MACD_signal        33
MACD_diff          33
Price_change        1
Volume_change       1
SMA_10_20_cross    19
SMA_20_50_cross    49
news_count         61
dtype: int64
Dropped 97 rows with missing values
Missing values after handling: 0
   BABA: Train=90.2%, Test=48.4%, Gap=41.8%
   üìä Average: Train=93.2%, Test=54.7%, Gap=38.5%

[10/13] Testing: Depth4+Alpha0.1
--------------------------------------------------------------------------------
Successfully fetched 251 days of data for NFLX
   üìä Found 803 articles (798 direct + 636 keyword)
   ü§ñ Calculating sentiment...
   ‚úÖ Processed 803 articles with sentiment
Fetching politician trading data for NFLX...
Successfully fetched 373 politician trades for NFLX
Date range: 2014-04-03 to 2025-10-28

Transaction type breakdown:
transaction_type
purchase          194
sale              144
sale (full)        31
sale (partial)      3
exchange            1
Name: count, dtype: int64
Creating SMA indicators...
Creating RSI indicator...
Creating MACD indicators...
Merging sentiment data...
Merging politician trade data...
Creating advanced politician features...
üèõÔ∏è  Creating advanced politician features...
   ‚úÖ Net position indicators: net_trade_index, net_dollar_flow, buy_percentage
   ‚úÖ Temporal features: 3 rolling windows + momentum
   ‚úÖ Recency indicator: days_since_last_trade
   ‚úÖ Quality metrics: conviction_score
   ‚úÖ Added 23 advanced politician features
      ‚úÖ Added 23 advanced politician features
Creating target variable...

Feature engineering complete!
Features shape: (250, 41)
Target shape: (250,)
Features: ['SMA_10', 'SMA_20', 'SMA_50', 'RSI', 'MACD', 'MACD_signal', 'MACD_diff', 'Price_change', 'Volume_change', 'HL_spread', 'SMA_10_20_cross', 'SMA_20_50_cross', 'avg_sentiment_compound', 'avg_sentiment_positive', 'avg_sentiment_negative', 'news_count', 'politician_buy_count', 'politician_trade_amount', 'buy_count', 'sell_count', 'full_sale_count', 'partial_sale_count', 'total_amount', 'buy_amount', 'sell_amount', 'net_trade_index', 'net_dollar_flow', 'buy_percentage', 'trades_last_30d', 'amount_last_30d', 'net_flow_last_30d', 'trades_last_60d', 'amount_last_60d', 'net_flow_last_60d', 'trades_last_90d', 'amount_last_90d', 'net_flow_last_90d', 'trade_momentum_30d', 'dollar_momentum_30d', 'days_since_last_trade', 'conviction_score']

Target distribution:
Target
1    129
0    121
Name: count, dtype: int64
Class balance: 51.60% positive (price increase)

Missing values before handling:
SMA_10              9
SMA_20             19
SMA_50             49
RSI                13
MACD               25
MACD_signal        33
MACD_diff          33
Price_change        1
Volume_change       1
SMA_10_20_cross    19
SMA_20_50_cross    49
news_count         49
dtype: int64
Dropped 86 rows with missing values
Missing values after handling: 0
   NFLX: Train=100.0%, Test=57.6%, Gap=42.4%
Successfully fetched 251 days of data for NVDA
   üìä Found 513 articles (505 direct + 307 keyword)
   ü§ñ Calculating sentiment...
   ‚úÖ Processed 513 articles with sentiment
Fetching politician trading data for NVDA...
Successfully fetched 581 politician trades for NVDA
Date range: 2016-01-20 to 2025-11-03

Transaction type breakdown:
transaction_type
purchase          325
sale              227
sale (full)        16
sale (partial)     10
exchange            3
Name: count, dtype: int64
Creating SMA indicators...
Creating RSI indicator...
Creating MACD indicators...
Merging sentiment data...
Merging politician trade data...
Creating advanced politician features...
üèõÔ∏è  Creating advanced politician features...
   ‚úÖ Net position indicators: net_trade_index, net_dollar_flow, buy_percentage
   ‚úÖ Temporal features: 3 rolling windows + momentum
   ‚úÖ Recency indicator: days_since_last_trade
   ‚úÖ Quality metrics: conviction_score
   ‚úÖ Added 23 advanced politician features
      ‚úÖ Added 23 advanced politician features
Creating target variable...

Feature engineering complete!
Features shape: (250, 41)
Target shape: (250,)
Features: ['SMA_10', 'SMA_20', 'SMA_50', 'RSI', 'MACD', 'MACD_signal', 'MACD_diff', 'Price_change', 'Volume_change', 'HL_spread', 'SMA_10_20_cross', 'SMA_20_50_cross', 'avg_sentiment_compound', 'avg_sentiment_positive', 'avg_sentiment_negative', 'news_count', 'politician_buy_count', 'politician_trade_amount', 'buy_count', 'sell_count', 'full_sale_count', 'partial_sale_count', 'total_amount', 'buy_amount', 'sell_amount', 'net_trade_index', 'net_dollar_flow', 'buy_percentage', 'trades_last_30d', 'amount_last_30d', 'net_flow_last_30d', 'trades_last_60d', 'amount_last_60d', 'net_flow_last_60d', 'trades_last_90d', 'amount_last_90d', 'net_flow_last_90d', 'trade_momentum_30d', 'dollar_momentum_30d', 'days_since_last_trade', 'conviction_score']

Target distribution:
Target
1    136
0    114
Name: count, dtype: int64
Class balance: 54.40% positive (price increase)

Missing values before handling:
SMA_10              9
SMA_20             19
SMA_50             49
RSI                13
MACD               25
MACD_signal        33
MACD_diff          33
Price_change        1
Volume_change       1
SMA_10_20_cross    19
SMA_20_50_cross    49
news_count         74
dtype: int64
Dropped 105 rows with missing values
Missing values after handling: 0
   NVDA: Train=100.0%, Test=48.3%, Gap=51.7%
Successfully fetched 251 days of data for BABA
   üìä Found 450 articles (444 direct + 333 keyword)
   ü§ñ Calculating sentiment...
   ‚úÖ Processed 450 articles with sentiment
Fetching politician trading data for BABA...
Successfully fetched 238 politician trades for BABA
Date range: 2014-10-16 to 2025-10-05

Transaction type breakdown:
transaction_type
purchase          126
sale               98
sale (full)        13
sale (partial)      1
Name: count, dtype: int64
Creating SMA indicators...
Creating RSI indicator...
Creating MACD indicators...
Merging sentiment data...
Merging politician trade data...
Creating advanced politician features...
üèõÔ∏è  Creating advanced politician features...
   ‚úÖ Net position indicators: net_trade_index, net_dollar_flow, buy_percentage
   ‚úÖ Temporal features: 3 rolling windows + momentum
   ‚úÖ Recency indicator: days_since_last_trade
   ‚úÖ Quality metrics: conviction_score
   ‚úÖ Added 23 advanced politician features
      ‚úÖ Added 23 advanced politician features
Creating target variable...

Feature engineering complete!
Features shape: (250, 41)
Target shape: (250,)
Features: ['SMA_10', 'SMA_20', 'SMA_50', 'RSI', 'MACD', 'MACD_signal', 'MACD_diff', 'Price_change', 'Volume_change', 'HL_spread', 'SMA_10_20_cross', 'SMA_20_50_cross', 'avg_sentiment_compound', 'avg_sentiment_positive', 'avg_sentiment_negative', 'news_count', 'politician_buy_count', 'politician_trade_amount', 'buy_count', 'sell_count', 'full_sale_count', 'partial_sale_count', 'total_amount', 'buy_amount', 'sell_amount', 'net_trade_index', 'net_dollar_flow', 'buy_percentage', 'trades_last_30d', 'amount_last_30d', 'net_flow_last_30d', 'trades_last_60d', 'amount_last_60d', 'net_flow_last_60d', 'trades_last_90d', 'amount_last_90d', 'net_flow_last_90d', 'trade_momentum_30d', 'dollar_momentum_30d', 'days_since_last_trade', 'conviction_score']

Target distribution:
Target
1    141
0    109
Name: count, dtype: int64
Class balance: 56.40% positive (price increase)

Missing values before handling:
SMA_10              9
SMA_20             19
SMA_50             49
RSI                13
MACD               25
MACD_signal        33
MACD_diff          33
Price_change        1
Volume_change       1
SMA_10_20_cross    19
SMA_20_50_cross    49
news_count         61
dtype: int64
Dropped 97 rows with missing values
Missing values after handling: 0
   BABA: Train=100.0%, Test=67.7%, Gap=32.3%
   üìä Average: Train=100.0%, Test=57.9%, Gap=42.1%

[11/13] Testing: Depth3+Lambda5
--------------------------------------------------------------------------------
Successfully fetched 251 days of data for NFLX/Users/tobycoleman/mining/StockPrediction/venv/lib/python3.13/site-packages/xgboost/training.py:199: UserWarning: [14:54:26] WARNING: /Users/runner/work/xgboost/xgboost/src/learner.cc:790: 
Parameters: { "use_label_encoder" } are not used.

  bst.update(dtrain, iteration=i, fobj=obj)
/Users/tobycoleman/mining/StockPrediction/venv/lib/python3.13/site-packages/xgboost/training.py:199: UserWarning: [14:54:27] WARNING: /Users/runner/work/xgboost/xgboost/src/learner.cc:790: 
Parameters: { "use_label_encoder" } are not used.

  bst.update(dtrain, iteration=i, fobj=obj)
/Users/tobycoleman/mining/StockPrediction/venv/lib/python3.13/site-packages/xgboost/training.py:199: UserWarning: [14:54:28] WARNING: /Users/runner/work/xgboost/xgboost/src/learner.cc:790: 
Parameters: { "use_label_encoder" } are not used.

  bst.update(dtrain, iteration=i, fobj=obj)
/Users/tobycoleman/mining/StockPrediction/venv/lib/python3.13/site-packages/xgboost/training.py:199: UserWarning: [14:54:28] WARNING: /Users/runner/work/xgboost/xgboost/src/learner.cc:790: 
Parameters: { "use_label_encoder" } are not used.

  bst.update(dtrain, iteration=i, fobj=obj)

   üìä Found 803 articles (798 direct + 636 keyword)
   ü§ñ Calculating sentiment...
   ‚úÖ Processed 803 articles with sentiment
Fetching politician trading data for NFLX...
Successfully fetched 373 politician trades for NFLX
Date range: 2014-04-03 to 2025-10-28

Transaction type breakdown:
transaction_type
purchase          194
sale              144
sale (full)        31
sale (partial)      3
exchange            1
Name: count, dtype: int64
Creating SMA indicators...
Creating RSI indicator...
Creating MACD indicators...
Merging sentiment data...
Merging politician trade data...
Creating advanced politician features...
üèõÔ∏è  Creating advanced politician features...
   ‚úÖ Net position indicators: net_trade_index, net_dollar_flow, buy_percentage
   ‚úÖ Temporal features: 3 rolling windows + momentum
   ‚úÖ Recency indicator: days_since_last_trade
   ‚úÖ Quality metrics: conviction_score
   ‚úÖ Added 23 advanced politician features
      ‚úÖ Added 23 advanced politician features
Creating target variable...

Feature engineering complete!
Features shape: (250, 41)
Target shape: (250,)
Features: ['SMA_10', 'SMA_20', 'SMA_50', 'RSI', 'MACD', 'MACD_signal', 'MACD_diff', 'Price_change', 'Volume_change', 'HL_spread', 'SMA_10_20_cross', 'SMA_20_50_cross', 'avg_sentiment_compound', 'avg_sentiment_positive', 'avg_sentiment_negative', 'news_count', 'politician_buy_count', 'politician_trade_amount', 'buy_count', 'sell_count', 'full_sale_count', 'partial_sale_count', 'total_amount', 'buy_amount', 'sell_amount', 'net_trade_index', 'net_dollar_flow', 'buy_percentage', 'trades_last_30d', 'amount_last_30d', 'net_flow_last_30d', 'trades_last_60d', 'amount_last_60d', 'net_flow_last_60d', 'trades_last_90d', 'amount_last_90d', 'net_flow_last_90d', 'trade_momentum_30d', 'dollar_momentum_30d', 'days_since_last_trade', 'conviction_score']

Target distribution:
Target
1    129
0    121
Name: count, dtype: int64
Class balance: 51.60% positive (price increase)

Missing values before handling:
SMA_10              9
SMA_20             19
SMA_50             49
RSI                13
MACD               25
MACD_signal        33
MACD_diff          33
Price_change        1
Volume_change       1
SMA_10_20_cross    19
SMA_20_50_cross    49
news_count         49
dtype: int64
Dropped 86 rows with missing values
Missing values after handling: 0
   NFLX: Train=98.5%, Test=66.7%, Gap=31.8%
Successfully fetched 251 days of data for NVDA
   üìä Found 513 articles (505 direct + 307 keyword)
   ü§ñ Calculating sentiment...
   ‚úÖ Processed 513 articles with sentiment
Fetching politician trading data for NVDA...
Successfully fetched 581 politician trades for NVDA
Date range: 2016-01-20 to 2025-11-03

Transaction type breakdown:
transaction_type
purchase          325
sale              227
sale (full)        16
sale (partial)     10
exchange            3
Name: count, dtype: int64
Creating SMA indicators...
Creating RSI indicator...
Creating MACD indicators...
Merging sentiment data...
Merging politician trade data...
Creating advanced politician features...
üèõÔ∏è  Creating advanced politician features...
   ‚úÖ Net position indicators: net_trade_index, net_dollar_flow, buy_percentage
   ‚úÖ Temporal features: 3 rolling windows + momentum
   ‚úÖ Recency indicator: days_since_last_trade
   ‚úÖ Quality metrics: conviction_score
   ‚úÖ Added 23 advanced politician features
      ‚úÖ Added 23 advanced politician features
Creating target variable...

Feature engineering complete!
Features shape: (250, 41)
Target shape: (250,)
Features: ['SMA_10', 'SMA_20', 'SMA_50', 'RSI', 'MACD', 'MACD_signal', 'MACD_diff', 'Price_change', 'Volume_change', 'HL_spread', 'SMA_10_20_cross', 'SMA_20_50_cross', 'avg_sentiment_compound', 'avg_sentiment_positive', 'avg_sentiment_negative', 'news_count', 'politician_buy_count', 'politician_trade_amount', 'buy_count', 'sell_count', 'full_sale_count', 'partial_sale_count', 'total_amount', 'buy_amount', 'sell_amount', 'net_trade_index', 'net_dollar_flow', 'buy_percentage', 'trades_last_30d', 'amount_last_30d', 'net_flow_last_30d', 'trades_last_60d', 'amount_last_60d', 'net_flow_last_60d', 'trades_last_90d', 'amount_last_90d', 'net_flow_last_90d', 'trade_momentum_30d', 'dollar_momentum_30d', 'days_since_last_trade', 'conviction_score']

Target distribution:
Target
1    136
0    114
Name: count, dtype: int64
Class balance: 54.40% positive (price increase)

Missing values before handling:
SMA_10              9
SMA_20             19
SMA_50             49
RSI                13
MACD               25
MACD_signal        33
MACD_diff          33
Price_change        1
Volume_change       1
SMA_10_20_cross    19
SMA_20_50_cross    49
news_count         74
dtype: int64
Dropped 105 rows with missing values
Missing values after handling: 0
   NVDA: Train=99.1%, Test=48.3%, Gap=50.9%
Successfully fetched 251 days of data for BABA
   üìä Found 450 articles (444 direct + 333 keyword)
   ü§ñ Calculating sentiment...
   ‚úÖ Processed 450 articles with sentiment
Fetching politician trading data for BABA...
Successfully fetched 238 politician trades for BABA
Date range: 2014-10-16 to 2025-10-05

Transaction type breakdown:
transaction_type
purchase          126
sale               98
sale (full)        13
sale (partial)      1
Name: count, dtype: int64
Creating SMA indicators...
Creating RSI indicator...
Creating MACD indicators...
Merging sentiment data...
Merging politician trade data...
Creating advanced politician features...
üèõÔ∏è  Creating advanced politician features...
   ‚úÖ Net position indicators: net_trade_index, net_dollar_flow, buy_percentage
   ‚úÖ Temporal features: 3 rolling windows + momentum
   ‚úÖ Recency indicator: days_since_last_trade
   ‚úÖ Quality metrics: conviction_score
   ‚úÖ Added 23 advanced politician features
      ‚úÖ Added 23 advanced politician features
Creating target variable...

Feature engineering complete!
Features shape: (250, 41)
Target shape: (250,)
Features: ['SMA_10', 'SMA_20', 'SMA_50', 'RSI', 'MACD', 'MACD_signal', 'MACD_diff', 'Price_change', 'Volume_change', 'HL_spread', 'SMA_10_20_cross', 'SMA_20_50_cross', 'avg_sentiment_compound', 'avg_sentiment_positive', 'avg_sentiment_negative', 'news_count', 'politician_buy_count', 'politician_trade_amount', 'buy_count', 'sell_count', 'full_sale_count', 'partial_sale_count', 'total_amount', 'buy_amount', 'sell_amount', 'net_trade_index', 'net_dollar_flow', 'buy_percentage', 'trades_last_30d', 'amount_last_30d', 'net_flow_last_30d', 'trades_last_60d', 'amount_last_60d', 'net_flow_last_60d', 'trades_last_90d', 'amount_last_90d', 'net_flow_last_90d', 'trade_momentum_30d', 'dollar_momentum_30d', 'days_since_last_trade', 'conviction_score']

Target distribution:
Target
1    141
0    109
Name: count, dtype: int64
Class balance: 56.40% positive (price increase)

Missing values before handling:
SMA_10              9
SMA_20             19
SMA_50             49
RSI                13
MACD               25
MACD_signal        33
MACD_diff          33
Price_change        1
Volume_change       1
SMA_10_20_cross    19
SMA_20_50_cross    49
news_count         61
dtype: int64
Dropped 97 rows with missing values
Missing values after handling: 0
   BABA: Train=99.2%, Test=64.5%, Gap=34.7%
   üìä Average: Train=98.9%, Test=59.8%, Gap=39.1%

[12/13] Testing: Depth4+MinChild3
--------------------------------------------------------------------------------
Successfully fetched 251 days of data for NFLX
   üìä Found 803 articles (798 direct + 636 keyword)
   ü§ñ Calculating sentiment...
   ‚úÖ Processed 803 articles with sentiment
Fetching politician trading data for NFLX...
Error fetching politician trades: HTTPSConnectionPool(host='api.quiverquant.com', port=443): Read timed out. (read timeout=15)
Returning empty DataFrame
Creating SMA indicators...
Creating RSI indicator...
Creating MACD indicators...
Merging sentiment data...
No politician trade data provided - skipping politician features
Creating target variable...

Feature engineering complete!
Features shape: (250, 16)
Target shape: (250,)
Features: ['SMA_10', 'SMA_20', 'SMA_50', 'RSI', 'MACD', 'MACD_signal', 'MACD_diff', 'Price_change', 'Volume_change', 'HL_spread', 'SMA_10_20_cross', 'SMA_20_50_cross', 'avg_sentiment_compound', 'avg_sentiment_positive', 'avg_sentiment_negative', 'news_count']/Users/tobycoleman/mining/StockPrediction/venv/lib/python3.13/site-packages/xgboost/training.py:199: UserWarning: [14:54:29] WARNING: /Users/runner/work/xgboost/xgboost/src/learner.cc:790: 
Parameters: { "use_label_encoder" } are not used.

  bst.update(dtrain, iteration=i, fobj=obj)
/Users/tobycoleman/mining/StockPrediction/venv/lib/python3.13/site-packages/xgboost/training.py:199: UserWarning: [14:54:29] WARNING: /Users/runner/work/xgboost/xgboost/src/learner.cc:790: 
Parameters: { "use_label_encoder" } are not used.

  bst.update(dtrain, iteration=i, fobj=obj)


Target distribution:
Target
1    129
0    121
Name: count, dtype: int64
Class balance: 51.60% positive (price increase)

Missing values before handling:
SMA_10              9
SMA_20             19
SMA_50             49
RSI                13
MACD               25
MACD_signal        33
MACD_diff          33
Price_change        1
Volume_change       1
SMA_10_20_cross    19
SMA_20_50_cross    49
news_count         49
dtype: int64
Dropped 86 rows with missing values
Missing values after handling: 0
   NFLX: Train=100.0%, Test=63.6%, Gap=36.4%
Successfully fetched 251 days of data for NVDA
   üìä Found 513 articles (505 direct + 307 keyword)
   ü§ñ Calculating sentiment...
   ‚úÖ Processed 513 articles with sentiment
Fetching politician trading data for NVDA...
Successfully fetched 581 politician trades for NVDA
Date range: 2016-01-20 to 2025-11-03

Transaction type breakdown:
transaction_type
purchase          325
sale              227
sale (full)        16
sale (partial)     10
exchange            3
Name: count, dtype: int64
Creating SMA indicators...
Creating RSI indicator...
Creating MACD indicators...
Merging sentiment data...
Merging politician trade data...
Creating advanced politician features...
üèõÔ∏è  Creating advanced politician features...
   ‚úÖ Net position indicators: net_trade_index, net_dollar_flow, buy_percentage
   ‚úÖ Temporal features: 3 rolling windows + momentum
   ‚úÖ Recency indicator: days_since_last_trade
   ‚úÖ Quality metrics: conviction_score
   ‚úÖ Added 23 advanced politician features
      ‚úÖ Added 23 advanced politician features
Creating target variable...

Feature engineering complete!
Features shape: (250, 41)
Target shape: (250,)
Features: ['SMA_10', 'SMA_20', 'SMA_50', 'RSI', 'MACD', 'MACD_signal', 'MACD_diff', 'Price_change', 'Volume_change', 'HL_spread', 'SMA_10_20_cross', 'SMA_20_50_cross', 'avg_sentiment_compound', 'avg_sentiment_positive', 'avg_sentiment_negative', 'news_count', 'politician_buy_count', 'politician_trade_amount', 'buy_count', 'sell_count', 'full_sale_count', 'partial_sale_count', 'total_amount', 'buy_amount', 'sell_amount', 'net_trade_index', 'net_dollar_flow', 'buy_percentage', 'trades_last_30d', 'amount_last_30d', 'net_flow_last_30d', 'trades_last_60d', 'amount_last_60d', 'net_flow_last_60d', 'trades_last_90d', 'amount_last_90d', 'net_flow_last_90d', 'trade_momentum_30d', 'dollar_momentum_30d', 'days_since_last_trade', 'conviction_score']

Target distribution:
Target
1    136
0    114
Name: count, dtype: int64
Class balance: 54.40% positive (price increase)

Missing values before handling:
SMA_10              9
SMA_20             19
SMA_50             49
RSI                13
MACD               25
MACD_signal        33
MACD_diff          33
Price_change        1
Volume_change       1
SMA_10_20_cross    19
SMA_20_50_cross    49
news_count         74
dtype: int64
Dropped 105 rows with missing values
Missing values after handling: 0
   NVDA: Train=100.0%, Test=51.7%, Gap=48.3%
Successfully fetched 251 days of data for BABA
   üìä Found 450 articles (444 direct + 333 keyword)
   ü§ñ Calculating sentiment...
   ‚úÖ Processed 450 articles with sentiment
Fetching politician trading data for BABA...
Successfully fetched 238 politician trades for BABA
Date range: 2014-10-16 to 2025-10-05

Transaction type breakdown:
transaction_type
purchase          126
sale               98
sale (full)        13
sale (partial)      1
Name: count, dtype: int64
Creating SMA indicators...
Creating RSI indicator...
Creating MACD indicators...
Merging sentiment data...
Merging politician trade data...
Creating advanced politician features...
üèõÔ∏è  Creating advanced politician features...
   ‚úÖ Net position indicators: net_trade_index, net_dollar_flow, buy_percentage
   ‚úÖ Temporal features: 3 rolling windows + momentum
   ‚úÖ Recency indicator: days_since_last_trade
   ‚úÖ Quality metrics: conviction_score
   ‚úÖ Added 23 advanced politician features
      ‚úÖ Added 23 advanced politician features
Creating target variable...

Feature engineering complete!
Features shape: (250, 41)
Target shape: (250,)
Features: ['SMA_10', 'SMA_20', 'SMA_50', 'RSI', 'MACD', 'MACD_signal', 'MACD_diff', 'Price_change', 'Volume_change', 'HL_spread', 'SMA_10_20_cross', 'SMA_20_50_cross', 'avg_sentiment_compound', 'avg_sentiment_positive', 'avg_sentiment_negative', 'news_count', 'politician_buy_count', 'politician_trade_amount', 'buy_count', 'sell_count', 'full_sale_count', 'partial_sale_count', 'total_amount', 'buy_amount', 'sell_amount', 'net_trade_index', 'net_dollar_flow', 'buy_percentage', 'trades_last_30d', 'amount_last_30d', 'net_flow_last_30d', 'trades_last_60d', 'amount_last_60d', 'net_flow_last_60d', 'trades_last_90d', 'amount_last_90d', 'net_flow_last_90d', 'trade_momentum_30d', 'dollar_momentum_30d', 'days_since_last_trade', 'conviction_score']

Target distribution:
Target
1    141
0    109
Name: count, dtype: int64
Class balance: 56.40% positive (price increase)

Missing values before handling:
SMA_10              9
SMA_20             19
SMA_50             49
RSI                13
MACD               25
MACD_signal        33
MACD_diff          33
Price_change        1
Volume_change       1
SMA_10_20_cross    19
SMA_20_50_cross    49
news_count         61
dtype: int64
Dropped 97 rows with missing values
Missing values after handling: 0
   BABA: Train=99.2%, Test=58.1%, Gap=41.1%
   üìä Average: Train=99.7%, Test=57.8%, Gap=41.9%

[13/13] Testing: Conservative
--------------------------------------------------------------------------------
Successfully fetched 251 days of data for NFLX
   üìä Found 803 articles (798 direct + 636 keyword)
   ü§ñ Calculating sentiment...
   ‚úÖ Processed 803 articles with sentiment
Fetching politician trading data for NFLX...
Successfully fetched 373 politician trades for NFLX
Date range: 2014-04-03 to 2025-10-28

Transaction type breakdown:
transaction_type
purchase          194
sale              144
sale (full)        31
sale (partial)      3
exchange            1
Name: count, dtype: int64
Creating SMA indicators...
Creating RSI indicator...
Creating MACD indicators...
Merging sentiment data...
Merging politician trade data...
Creating advanced politician features...
üèõÔ∏è  Creating advanced politician features...
   ‚úÖ Net position indicators: net_trade_index, net_dollar_flow, buy_percentage
   ‚úÖ Temporal features: 3 rolling windows + momentum
   ‚úÖ Recency indicator: days_since_last_trade
   ‚úÖ Quality metrics: conviction_score
   ‚úÖ Added 23 advanced politician features
      ‚úÖ Added 23 advanced politician features
Creating target variable...

Feature engineering complete!
Features shape: (250, 41)
Target shape: (250,)
Features: ['SMA_10', 'SMA_20', 'SMA_50', 'RSI', 'MACD', 'MACD_signal', 'MACD_diff', 'Price_change', 'Volume_change', 'HL_spread', 'SMA_10_20_cross', 'SMA_20_50_cross', 'avg_sentiment_compound', 'avg_sentiment_positive', 'avg_sentiment_negative', 'news_count', 'politician_buy_count', 'politician_trade_amount', 'buy_count', 'sell_count', 'full_sale_count', 'partial_sale_count', 'total_amount', 'buy_amount', 'sell_amount', 'net_trade_index', 'net_dollar_flow', 'buy_percentage', 'trades_last_30d', 'amount_last_30d', 'net_flow_last_30d', 'trades_last_60d', 'amount_last_60d', 'net_flow_last_60d', 'trades_last_90d', 'amount_last_90d', 'net_flow_last_90d', 'trade_momentum_30d', 'dollar_momentum_30d', 'days_since_last_trade', 'conviction_score']

Target distribution:
Target
1    129
0    121
Name: count, dtype: int64
Class balance: 51.60% positive (price increase)

Missing values before handling:
SMA_10              9
SMA_20             19
SMA_50             49
RSI                13
MACD               25
MACD_signal        33
MACD_diff          33
Price_change        1
Volume_change       1
SMA_10_20_cross    19
SMA_20_50_cross    49
news_count         49
dtype: int64
Dropped 86 rows with missing values
Missing values after handling: 0
   NFLX: Train=95.4%, Test=63.6%, Gap=31.8%
Successfully fetched 251 days of data for NVDA
   üìä Found 513 articles (505 direct + 307 keyword)
   ü§ñ Calculating sentiment...
   ‚úÖ Processed 513 articles with sentiment
Fetching politician trading data for NVDA...
Successfully fetched 581 politician trades for NVDA
Date range: 2016-01-20 to 2025-11-03

Transaction type breakdown:
transaction_type
purchase          325
sale              227
sale (full)        16
sale (partial)     10
exchange            3
Name: count, dtype: int64
Creating SMA indicators...
Creating RSI indicator...
Creating MACD indicators...
Merging sentiment data...
Merging politician trade data...
Creating advanced politician features...
üèõÔ∏è  Creating advanced politician features...
   ‚úÖ Net position indicators: net_trade_index, net_dollar_flow, buy_percentage
   ‚úÖ Temporal features: 3 rolling windows + momentum
   ‚úÖ Recency indicator: days_since_last_trade
   ‚úÖ Quality metrics: conviction_score
   ‚úÖ Added 23 advanced politician features
      ‚úÖ Added 23 advanced politician features
Creating target variable...

Feature engineering complete!
Features shape: (250, 41)
Target shape: (250,)
Features: ['SMA_10', 'SMA_20', 'SMA_50', 'RSI', 'MACD', 'MACD_signal', 'MACD_diff', 'Price_change', 'Volume_change', 'HL_spread', 'SMA_10_20_cross', 'SMA_20_50_cross', 'avg_sentiment_compound', 'avg_sentiment_positive', 'avg_sentiment_negative', 'news_count', 'politician_buy_count', 'politician_trade_amount', 'buy_count', 'sell_count', 'full_sale_count', 'partial_sale_count', 'total_amount', 'buy_amount', 'sell_amount', 'net_trade_index', 'net_dollar_flow', 'buy_percentage', 'trades_last_30d', 'amount_last_30d', 'net_flow_last_30d', 'trades_last_60d', 'amount_last_60d', 'net_flow_last_60d', 'trades_last_90d', 'amount_last_90d', 'net_flow_last_90d', 'trade_momentum_30d', 'dollar_momentum_30d', 'days_since_last_trade', 'conviction_score']

Target distribution:
Target
1    136
0    114
Name: count, dtype: int64
Class balance: 54.40% positive (price increase)

Missing values before handling:
SMA_10              9
SMA_20             19
SMA_50             49
RSI                13
MACD               25
MACD_signal        33
MACD_diff          33
Price_change        1
Volume_change       1
SMA_10_20_cross    19
SMA_20_50_cross    49
news_count         74
dtype: int64
Dropped 105 rows with missing values
Missing values after handling: 0
   NVDA: Train=99.1%, Test=51.7%, Gap=47.4%
Successfully fetched 251 days of data for BABA
   üìä Found 450 articles (444 direct + 333 keyword)
   ü§ñ Calculating sentiment...
   ‚úÖ Processed 450 articles with sentiment
Fetching politician trading data for BABA...
Successfully fetched 238 politician trades for BABA
Date range: 2014-10-16 to 2025-10-05

Transaction type breakdown:
transaction_type
purchase          126
sale               98
sale (full)        13
sale (partial)      1
Name: count, dtype: int64
Creating SMA indicators...
Creating RSI indicator...
Creating MACD indicators...
Merging sentiment data...
Merging politician trade data...
Creating advanced politician features...
üèõÔ∏è  Creating advanced politician features...
   ‚úÖ Net position indicators: net_trade_index, net_dollar_flow, buy_percentage
   ‚úÖ Temporal features: 3 rolling windows + momentum
   ‚úÖ Recency indicator: days_since_last_trade
   ‚úÖ Quality metrics: conviction_score
   ‚úÖ Added 23 advanced politician features
      ‚úÖ Added 23 advanced politician features
Creating target variable...

Feature engineering complete!
Features shape: (250, 41)
Target shape: (250,)
Features: ['SMA_10', 'SMA_20', 'SMA_50', 'RSI', 'MACD', 'MACD_signal', 'MACD_diff', 'Price_change', 'Volume_change', 'HL_spread', 'SMA_10_20_cross', 'SMA_20_50_cross', 'avg_sentiment_compound', 'avg_sentiment_positive', 'avg_sentiment_negative', 'news_count', 'politician_buy_count', 'politician_trade_amount', 'buy_count', 'sell_count', 'full_sale_count', 'partial_sale_count', 'total_amount', 'buy_amount', 'sell_amount', 'net_trade_index', 'net_dollar_flow', 'buy_percentage', 'trades_last_30d', 'amount_last_30d', 'net_flow_last_30d', 'trades_last_60d', 'amount_last_60d', 'net_flow_last_60d', 'trades_last_90d', 'amount_last_90d', 'net_flow_last_90d', 'trade_momentum_30d', 'dollar_momentum_30d', 'days_since_last_trade', 'conviction_score']

Target distribution:
Target
1    141
0    109
Name: count, dtype: int64
Class balance: 56.40% positive (price increase)

Missing values before handling:
SMA_10              9
SMA_20             19
SMA_50             49
RSI                13
MACD               25
MACD_signal        33
MACD_diff          33
Price_change        1
Volume_change       1
SMA_10_20_cross    19
SMA_20_50_cross    49
news_count         61
dtype: int64
Dropped 97 rows with missing values
Missing values after handling: 0
   BABA: Train=91.8%, Test=64.5%, Gap=27.3%
   üìä Average: Train=95.5%, Test=60.0%, Gap=35.5%

================================================================================
[4/4] Saving results...
‚úÖ Saved to results/overfitting_experiments.csv

================================================================================
EXPERIMENT RESULTS SUMMARY
================================================================================

Experiment           Avg Train    Avg Test     Overfit Gap    Gap Reduction  
--------------------------------------------------------------------------------
Alpha=1.0            100.0%       67.4%        32.6%          1136.4%        
Conservative         95.5%        60.0%        35.5%          850.5%         
MinChild=3           100.0%       63.3%        36.7%          725.9%         
MinChild=5           93.2%        54.7%        38.5%          553.9%         
Depth3+Lambda5       98.9%        59.8%        39.1%          488.9%         
MaxDepth=4           100.0%       59.1%        40.9%          307.9%         
Depth4+MinChild3     99.7%        57.8%        41.9%          208.2%         
Depth4+Alpha0.1      100.0%       57.9%        42.1%          186.5%         
Alpha=0.1            100.0%       54.6%        45.4%          -137.0%        
Baseline             100.0%       54.4%        45.6%          -164.9%        
MaxDepth=3           100.0%       53.7%        46.3%          -225.0%        
Lambda=5             100.0%       53.6%        46.4%          -238.0%        
Lambda=10            100.0%       51.4%        48.6%          -459.6%        

================================================================================
BEST CONFIGURATIONS:
================================================================================

1. SMALLEST OVERFIT GAP (Top 3):
--------------------------------------------------------------------------------
1. Alpha=1.0
   max_depth=6, min_child_weight=1, alpha=1.0, lambda=1
   Gap: 32.6% (improvement: 1136.4%)
   Test Accuracy: 67.4%

2. Conservative
   max_depth=3, min_child_weight=3, alpha=0.5, lambda=5
   Gap: 35.5% (improvement: 850.5%)
   Test Accuracy: 60.0%

3. MinChild=3
   max_depth=6, min_child_weight=3, alpha=0.0, lambda=1
   Gap: 36.7% (improvement: 725.9%)
   Test Accuracy: 63.3%

2. HIGHEST TEST ACCURACY (Top 3):
--------------------------------------------------------------------------------
1. Alpha=1.0
   max_depth=6, min_child_weight=1, alpha=1.0, lambda=1
   Test Accuracy: 67.4%
   Gap: 32.6%

2. MinChild=3
   max_depth=6, min_child_weight=3, alpha=0.0, lambda=1
   Test Accuracy: 63.3%
   Gap: 36.7%

3. Conservative
   max_depth=3, min_child_weight=3, alpha=0.5, lambda=5
   Test Accuracy: 60.0%
   Gap: 35.5%

================================================================================
RECOMMENDATIONS:
================================================================================

‚úÖ RECOMMENDED CONFIGURATION: Alpha=1.0
   Parameters:
   - max_depth = 6
   - min_child_weight = 1
   - alpha = 1.0
   - lambda = 1
   - gamma = 0.0

   Expected Performance:
   - Test Accuracy: 67.4%
   - Overfit Gap: 32.6% (vs baseline 44%)
   - Gap Reduction: 1136.4%

================================================================================
Completed: 2025-11-04 14:54:29
================================================================================
